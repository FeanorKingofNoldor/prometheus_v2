<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2684px" preserveAspectRatio="none" style="width:3453px;height:2684px;" version="1.1" viewBox="0 0 3453 2684" width="3453px" zoomAndPan="magnify"><defs><filter height="300%" id="f8357kn0r3jmr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[3379a0ae215184560f889705ba3be7a3]
cluster prometheus.core--><rect fill="#E8F5E9" filter="url(#f8357kn0r3jmr)" height="222" style="stroke: #000000; stroke-width: 1.5;" width="1698" x="1245" y="2451"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="2034.5" y="2467.9659">prometheus.core</text><!--MD5=[4329b0ab66cac4235b52d10c538bff3a]
cluster prometheus.data--><rect fill="#FFF3E0" filter="url(#f8357kn0r3jmr)" height="455.5" style="stroke: #000000; stroke-width: 1.5;" width="859" x="2147" y="1939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="2516.5" y="1955.9659">prometheus.data</text><!--MD5=[765294182d97ccb916ff5e8b2e987eff]
cluster prometheus.encoders--><rect fill="#FFF3E0" filter="url(#f8357kn0r3jmr)" height="192" style="stroke: #000000; stroke-width: 1.5;" width="1378" x="667" y="1939"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="1280" y="1955.9659">prometheus.encoders</text><!--MD5=[df79864851f749fb25e06540e2dfa812]
cluster prometheus.profiles--><rect fill="#FFF3E0" filter="url(#f8357kn0r3jmr)" height="203" style="stroke: #000000; stroke-width: 1.5;" width="990" x="22" y="1685"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="446.5" y="1701.9659">prometheus.profiles</text><!--MD5=[8c417eab85ca7a4550acf3f6981a8144]
cluster prometheus.regime--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="203" style="stroke: #000000; stroke-width: 1.5;" width="988" x="1036" y="1685"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1461" y="1701.9659">prometheus.regime</text><!--MD5=[491437b16a536e9a250c867d0acb9efd]
cluster prometheus.stability--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="233" style="stroke: #000000; stroke-width: 1.5;" width="850" x="887" y="1401"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="1239.5" y="1417.9659">prometheus.stability</text><!--MD5=[fdc12f917296a370a3370213396d7ca2]
cluster prometheus.assessment.fragility--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="218" style="stroke: #000000; stroke-width: 1.5;" width="667" x="997" y="1132"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="228" x="1216.5" y="1148.9659">prometheus.assessment.fragility</text><!--MD5=[4c3e0faad723d900ca16501794600085]
cluster prometheus.assessment--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="248" style="stroke: #000000; stroke-width: 1.5;" width="997" x="1101" y="833"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="1514.5" y="849.9659">prometheus.assessment</text><!--MD5=[1eba13f163f48c9d2cfcad3de095835d]
cluster prometheus.universe--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="218" style="stroke: #000000; stroke-width: 1.5;" width="571" x="1356" y="564"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="1567.5" y="580.9659">prometheus.universe</text><!--MD5=[7feeda4b888560c364b47a1eeb2b4d4d]
cluster prometheus.portfolio--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="248" style="stroke: #000000; stroke-width: 1.5;" width="839" x="1457" y="265"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="1801.5" y="281.9659">prometheus.portfolio</text><!--MD5=[7e5e6cc06e1594ea69830d9d7660c10b]
cluster prometheus.synthetic--><rect fill="#FFEBEE" filter="url(#f8357kn0r3jmr)" height="203" style="stroke: #000000; stroke-width: 1.5;" width="860" x="1951" y="571.5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="2304.5" y="588.4659">prometheus.synthetic</text><!--MD5=[f10ebd83bba6942ca662d8771ceea3e8]
cluster prometheus.execution--><rect fill="#E3F2FD" filter="url(#f8357kn0r3jmr)" height="468.5" style="stroke: #000000; stroke-width: 1.5;" width="949" x="2320" y="24"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="2716" y="40.9659">prometheus.execution</text><!--MD5=[e3ef796132519fd7c630b457091da79a]
cluster prometheus.meta--><rect fill="#F3E5F5" filter="url(#f8357kn0r3jmr)" height="218" style="stroke: #000000; stroke-width: 1.5;" width="1050" x="885" y="2182"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="125" x="1347.5" y="2198.9659">prometheus.meta</text><!--MD5=[90b94cb35a8e273dae98f333980f631a]
cluster prometheus.orchestration--><rect fill="#F3E5F5" filter="url(#f8357kn0r3jmr)" height="440.5" style="stroke: #000000; stroke-width: 1.5;" width="412" x="3030" y="2195"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="183" x="3144.5" y="2211.9659">prometheus.orchestration</text><!--MD5=[4bf8aff396996fef456cd268939daa24]
class Config--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="Config" style="stroke: #A80036; stroke-width: 1.5;" width="284" x="2262" y="2511.5"/><ellipse cx="2381.75" cy="2527.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2384.7188,2533.1406 Q2384.1406,2533.4375 2383.5,2533.5781 Q2382.8594,2533.7344 2382.1563,2533.7344 Q2379.6563,2533.7344 2378.3281,2532.0938 Q2377.0156,2530.4375 2377.0156,2527.3125 Q2377.0156,2524.1875 2378.3281,2522.5313 Q2379.6563,2520.875 2382.1563,2520.875 Q2382.8594,2520.875 2383.5,2521.0313 Q2384.1563,2521.1875 2384.7188,2521.4844 L2384.7188,2524.2031 Q2384.0938,2523.625 2383.5,2523.3594 Q2382.9063,2523.0781 2382.2813,2523.0781 Q2380.9375,2523.0781 2380.25,2524.1563 Q2379.5625,2525.2188 2379.5625,2527.3125 Q2379.5625,2529.4063 2380.25,2530.4844 Q2380.9375,2531.5469 2382.2813,2531.5469 Q2382.9063,2531.5469 2383.5,2531.2813 Q2384.0938,2531 2384.7188,2530.4219 L2384.7188,2533.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="36" x="2402.25" y="2532.156">Config</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2263" x2="2545" y1="2543.5" y2="2543.5"/><ellipse cx="2273" cy="2554.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="2282" y="2559.2589">load_config(path: str) : Dict</text><ellipse cx="2273" cy="2569.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="258" x="2282" y="2574.2408">get_engine_config(engine_name: str) : BaseModel</text><ellipse cx="2273" cy="2584.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="2282" y="2589.2227">validate_config(config: Dict) : bool</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2263" x2="2545" y1="2596.4457" y2="2596.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2270" y="2604.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="228" x="2282" y="2612.2046">_resolve_overlays(base: Dict, env: Dict) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2270" y="2619.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="2282" y="2627.1865">_instantiate_models(config: Dict) : BaseModel</text><!--MD5=[ed3afe56f065d25b4329669e73deaf58]
class Database--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="Database" style="stroke: #A80036; stroke-width: 1.5;" width="280" x="1652" y="2511.5"/><ellipse cx="1760.75" cy="2527.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1763.7188,2533.1406 Q1763.1406,2533.4375 1762.5,2533.5781 Q1761.8594,2533.7344 1761.1563,2533.7344 Q1758.6563,2533.7344 1757.3281,2532.0938 Q1756.0156,2530.4375 1756.0156,2527.3125 Q1756.0156,2524.1875 1757.3281,2522.5313 Q1758.6563,2520.875 1761.1563,2520.875 Q1761.8594,2520.875 1762.5,2521.0313 Q1763.1563,2521.1875 1763.7188,2521.4844 L1763.7188,2524.2031 Q1763.0938,2523.625 1762.5,2523.3594 Q1761.9063,2523.0781 1761.2813,2523.0781 Q1759.9375,2523.0781 1759.25,2524.1563 Q1758.5625,2525.2188 1758.5625,2527.3125 Q1758.5625,2529.4063 1759.25,2530.4844 Q1759.9375,2531.5469 1761.2813,2531.5469 Q1761.9063,2531.5469 1762.5,2531.2813 Q1763.0938,2531 1763.7188,2530.4219 L1763.7188,2533.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="1781.25" y="2532.156">Database</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1653" x2="1931" y1="2543.5" y2="2543.5"/><ellipse cx="1663" cy="2554.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="1672" y="2559.2589">get_connection(db_name: str) : Connection</text><ellipse cx="1663" cy="2569.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="1672" y="2574.2408">execute_query(query: str, params: Dict) : Result</text><ellipse cx="1663" cy="2584.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="1672" y="2589.2227">get_session() : Session</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1653" x2="1931" y1="2596.4457" y2="2596.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1660" y="2604.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="1672" y="2612.2046">_create_pool(config: DbConfig) : ConnectionPool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1660" y="2619.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="1672" y="2627.1865">_health_check() : bool</text><!--MD5=[248f897e4bb16c2722904b15df30346f]
class Logger--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="Logger" style="stroke: #A80036; stroke-width: 1.5;" width="259" x="1967.5" y="2511.5"/><ellipse cx="2073.25" cy="2527.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2076.2188,2533.1406 Q2075.6406,2533.4375 2075,2533.5781 Q2074.3594,2533.7344 2073.6563,2533.7344 Q2071.1563,2533.7344 2069.8281,2532.0938 Q2068.5156,2530.4375 2068.5156,2527.3125 Q2068.5156,2524.1875 2069.8281,2522.5313 Q2071.1563,2520.875 2073.6563,2520.875 Q2074.3594,2520.875 2075,2521.0313 Q2075.6563,2521.1875 2076.2188,2521.4844 L2076.2188,2524.2031 Q2075.5938,2523.625 2075,2523.3594 Q2074.4063,2523.0781 2073.7813,2523.0781 Q2072.4375,2523.0781 2071.75,2524.1563 Q2071.0625,2525.2188 2071.0625,2527.3125 Q2071.0625,2529.4063 2071.75,2530.4844 Q2072.4375,2531.5469 2073.7813,2531.5469 Q2074.4063,2531.5469 2075,2531.2813 Q2075.5938,2531 2076.2188,2530.4219 L2076.2188,2533.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="39" x="2093.75" y="2532.156">Logger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1968.5" x2="2225.5" y1="2543.5" y2="2543.5"/><ellipse cx="1978.5" cy="2554.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="1987.5" y="2559.2589">log_info(msg: str, **kwargs)</text><ellipse cx="1978.5" cy="2569.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="1987.5" y="2574.2408">log_warning(msg: str, **kwargs)</text><ellipse cx="1978.5" cy="2584.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="1987.5" y="2589.2227">log_error(msg: str, **kwargs)</text><ellipse cx="1978.5" cy="2599.4457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="202" x="1987.5" y="2604.2046">log_decision(engine: str, decision: Dict)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1968.5" x2="2225.5" y1="2611.4276" y2="2611.4276"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1975.5" y="2619.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="1987.5" y="2627.1865">_format_message(msg: str, context: Dict) : str</text><!--MD5=[46fa6ab6c26fd94da39999528180b540]
class TradingCalendar--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="167.8551" id="TradingCalendar" style="stroke: #A80036; stroke-width: 1.5;" width="346" x="2581" y="2489"/><ellipse cx="2702.75" cy="2505" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2705.7188,2510.6406 Q2705.1406,2510.9375 2704.5,2511.0781 Q2703.8594,2511.2344 2703.1563,2511.2344 Q2700.6563,2511.2344 2699.3281,2509.5938 Q2698.0156,2507.9375 2698.0156,2504.8125 Q2698.0156,2501.6875 2699.3281,2500.0313 Q2700.6563,2498.375 2703.1563,2498.375 Q2703.8594,2498.375 2704.5,2498.5313 Q2705.1563,2498.6875 2705.7188,2498.9844 L2705.7188,2501.7031 Q2705.0938,2501.125 2704.5,2500.8594 Q2703.9063,2500.5781 2703.2813,2500.5781 Q2701.9375,2500.5781 2701.25,2501.6563 Q2700.5625,2502.7188 2700.5625,2504.8125 Q2700.5625,2506.9063 2701.25,2507.9844 Q2701.9375,2509.0469 2703.2813,2509.0469 Q2703.9063,2509.0469 2704.5,2508.7813 Q2705.0938,2508.5 2705.7188,2507.9219 L2705.7188,2510.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="2723.25" y="2509.656">TradingCalendar</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2582" x2="2926" y1="2521" y2="2521"/><ellipse cx="2592" cy="2532" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="2601" y="2536.7589">is_trading_day(market_id: str, date: date) : bool</text><ellipse cx="2592" cy="2546.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="315" x="2601" y="2551.7408">get_prev_trading_day(market_id: str, date: date, n: int) : date</text><ellipse cx="2592" cy="2561.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="2601" y="2566.7227">get_next_trading_day(market_id: str, date: date, n: int) : date</text><ellipse cx="2592" cy="2576.9457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="2601" y="2581.7046">session_open(market_id: str, date: date) : datetime</text><ellipse cx="2592" cy="2591.9276" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="2601" y="2596.6865">session_close(market_id: str, date: date) : datetime</text><ellipse cx="2592" cy="2606.9094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="320" x="2601" y="2611.6684">get_market_state(market_id: str, now: datetime) : MarketState</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2582" x2="2926" y1="2618.8913" y2="2618.8913"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2589" y="2626.8913"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="2601" y="2634.6502">_load_calendar(market_id: str) : Calendar</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2589" y="2641.8732"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="2601" y="2649.6321">_is_holiday(market_id: str, date: date) : bool</text><!--MD5=[70ed871e77a41e424a5ed7fef31572b8]
class IDGenerator--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="107.9276" id="IDGenerator" style="stroke: #A80036; stroke-width: 1.5;" width="355" x="1261.5" y="2519"/><ellipse cx="1399.25" cy="2535" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1402.2188,2540.6406 Q1401.6406,2540.9375 1401,2541.0781 Q1400.3594,2541.2344 1399.6563,2541.2344 Q1397.1563,2541.2344 1395.8281,2539.5938 Q1394.5156,2537.9375 1394.5156,2534.8125 Q1394.5156,2531.6875 1395.8281,2530.0313 Q1397.1563,2528.375 1399.6563,2528.375 Q1400.3594,2528.375 1401,2528.5313 Q1401.6563,2528.6875 1402.2188,2528.9844 L1402.2188,2531.7031 Q1401.5938,2531.125 1401,2530.8594 Q1400.4063,2530.5781 1399.7813,2530.5781 Q1398.4375,2530.5781 1397.75,2531.6563 Q1397.0625,2532.7188 1397.0625,2534.8125 Q1397.0625,2536.9063 1397.75,2537.9844 Q1398.4375,2539.0469 1399.7813,2539.0469 Q1400.4063,2539.0469 1401,2538.7813 Q1401.5938,2538.5 1402.2188,2537.9219 L1402.2188,2540.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="1419.75" y="2539.656">IDGenerator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1262.5" x2="1615.5" y1="2551" y2="2551"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1262.5" x2="1615.5" y1="2559" y2="2559"/><ellipse cx="1272.5" cy="2570" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="105" x="1281.5" y="2574.7589">generate_uuid() : str</text><ellipse cx="1272.5" cy="2584.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="1281.5" y="2589.7408">generate_order_id() : str</text><ellipse cx="1272.5" cy="2599.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="1281.5" y="2604.7227">generate_decision_id() : str</text><ellipse cx="1272.5" cy="2614.9457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="329" x="1281.5" y="2619.7046">generate_context_id(date: date, portfolio: str, strategy: str) : str</text><!--MD5=[40f35fe2d6e1cffa105ee65d15f1bcf9]
class DataReader--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="152.8732" id="DataReader" style="stroke: #A80036; stroke-width: 1.5;" width="485" x="2163.5" y="2225.5"/><ellipse cx="2368.25" cy="2241.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2371.2188,2247.1406 Q2370.6406,2247.4375 2370,2247.5781 Q2369.3594,2247.7344 2368.6563,2247.7344 Q2366.1563,2247.7344 2364.8281,2246.0938 Q2363.5156,2244.4375 2363.5156,2241.3125 Q2363.5156,2238.1875 2364.8281,2236.5313 Q2366.1563,2234.875 2368.6563,2234.875 Q2369.3594,2234.875 2370,2235.0313 Q2370.6563,2235.1875 2371.2188,2235.4844 L2371.2188,2238.2031 Q2370.5938,2237.625 2370,2237.3594 Q2369.4063,2237.0781 2368.7813,2237.0781 Q2367.4375,2237.0781 2366.75,2238.1563 Q2366.0625,2239.2188 2366.0625,2241.3125 Q2366.0625,2243.4063 2366.75,2244.4844 Q2367.4375,2245.5469 2368.7813,2245.5469 Q2369.4063,2245.5469 2370,2245.2813 Q2370.5938,2245 2371.2188,2244.4219 L2371.2188,2247.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="2388.75" y="2246.156">DataReader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2164.5" x2="2647.5" y1="2257.5" y2="2257.5"/><ellipse cx="2174.5" cy="2268.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="370" x="2183.5" y="2273.2589">read_prices(instrument_ids: List[str], start: date, end: date) : DataFrame</text><ellipse cx="2174.5" cy="2283.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="378" x="2183.5" y="2288.2408">read_returns(instrument_ids: List[str], start: date, end: date) : DataFrame</text><ellipse cx="2174.5" cy="2298.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="348" x="2183.5" y="2303.2227">read_factors(factor_ids: List[str], start: date, end: date) : DataFrame</text><ellipse cx="2174.5" cy="2313.4457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="381" x="2183.5" y="2318.2046">read_profiles(issuer_ids: List[str], as_of_date: date) : List[ProfileSnapshot]</text><ellipse cx="2174.5" cy="2328.4276" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="459" x="2183.5" y="2333.1865">read_embeddings(entity_ids: List[str], model_id: str, as_of_date: date) : Dict[str, ndarray]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2164.5" x2="2647.5" y1="2340.4094" y2="2340.4094"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2171.5" y="2348.4094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="2183.5" y="2356.1684">_build_query(table: str, filters: Dict) : str</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2171.5" y="2363.3913"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="316" x="2183.5" y="2371.1502">_fetch_batch(query: str, batch_size: int) : Iterator[DataFrame]</text><!--MD5=[5802f21d0866b10fa8e83dcd8563eeb7]
class FeatureBuilder--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="FeatureBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="427" x="2562.5" y="1977"/><ellipse cx="2730.25" cy="1993" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2733.2188,1998.6406 Q2732.6406,1998.9375 2732,1999.0781 Q2731.3594,1999.2344 2730.6563,1999.2344 Q2728.1563,1999.2344 2726.8281,1997.5938 Q2725.5156,1995.9375 2725.5156,1992.8125 Q2725.5156,1989.6875 2726.8281,1988.0313 Q2728.1563,1986.375 2730.6563,1986.375 Q2731.3594,1986.375 2732,1986.5313 Q2732.6563,1986.6875 2733.2188,1986.9844 L2733.2188,1989.7031 Q2732.5938,1989.125 2732,1988.8594 Q2731.4063,1988.5781 2730.7813,1988.5781 Q2729.4375,1988.5781 2728.75,1989.6563 Q2728.0625,1990.7188 2728.0625,1992.8125 Q2728.0625,1994.9063 2728.75,1995.9844 Q2729.4375,1997.0469 2730.7813,1997.0469 Q2731.4063,1997.0469 2732,1996.7813 Q2732.5938,1996.5 2733.2188,1995.9219 L2733.2188,1998.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="83" x="2750.75" y="1997.656">FeatureBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2563.5" x2="2988.5" y1="2009" y2="2009"/><ellipse cx="2573.5" cy="2020" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="388" x="2582.5" y="2024.7589">build_returns_windows(prices: DataFrame, windows: List[int]) : DataFrame</text><ellipse cx="2573.5" cy="2034.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="350" x="2582.5" y="2039.7408">build_volatility(returns: DataFrame, windows: List[int]) : DataFrame</text><ellipse cx="2573.5" cy="2049.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="401" x="2582.5" y="2054.7227">build_factor_exposures(returns: DataFrame, factors: DataFrame) : DataFrame</text><ellipse cx="2573.5" cy="2064.9457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="356" x="2582.5" y="2069.7046">build_correlation_matrix(returns: DataFrame, window: int) : ndarray</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2563.5" x2="2988.5" y1="2076.9276" y2="2076.9276"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2570.5" y="2084.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="344" x="2582.5" y="2092.6865">_rolling_window(series: Series, window: int, func: Callable) : Series</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2570.5" y="2099.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="2582.5" y="2107.6684">_compute_ewma(series: Series, halflife: int) : Series</text><!--MD5=[ca1228a12131595ea705a47d1b4812c1]
class DataWriter--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="DataWriter" style="stroke: #A80036; stroke-width: 1.5;" width="364" x="2163" y="1984.5"/><ellipse cx="2309.75" cy="2000.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2312.7188,2006.1406 Q2312.1406,2006.4375 2311.5,2006.5781 Q2310.8594,2006.7344 2310.1563,2006.7344 Q2307.6563,2006.7344 2306.3281,2005.0938 Q2305.0156,2003.4375 2305.0156,2000.3125 Q2305.0156,1997.1875 2306.3281,1995.5313 Q2307.6563,1993.875 2310.1563,1993.875 Q2310.8594,1993.875 2311.5,1994.0313 Q2312.1563,1994.1875 2312.7188,1994.4844 L2312.7188,1997.2031 Q2312.0938,1996.625 2311.5,1996.3594 Q2310.9063,1996.0781 2310.2813,1996.0781 Q2308.9375,1996.0781 2308.25,1997.1563 Q2307.5625,1998.2188 2307.5625,2000.3125 Q2307.5625,2002.4063 2308.25,2003.4844 Q2308.9375,2004.5469 2310.2813,2004.5469 Q2310.9063,2004.5469 2311.5,2004.2813 Q2312.0938,2004 2312.7188,2003.4219 L2312.7188,2006.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="2330.25" y="2005.156">DataWriter</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2164" x2="2526" y1="2016.5" y2="2016.5"/><ellipse cx="2174" cy="2027.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="2183" y="2032.2589">write_prices(df: DataFrame, table: str)</text><ellipse cx="2174" cy="2042.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="338" x="2183" y="2047.2408">write_embeddings(embeddings: Dict[str, ndarray], model_id: str)</text><ellipse cx="2174" cy="2057.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="2183" y="2062.2227">write_engine_output(engine_name: str, output: Dict)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2164" x2="2526" y1="2069.4457" y2="2069.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2171" y="2077.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="255" x="2183" y="2085.2046">_validate_schema(df: DataFrame, table: str) : bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2171" y="2092.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="2183" y="2100.1865">_batch_insert(df: DataFrame, table: str, batch_size: int)</text><!--MD5=[8a50ee541607c0bb30568b375bf92213]
class TextEncoder--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="TextEncoder" style="stroke: #A80036; stroke-width: 1.5;" width="305" x="683.5" y="1977"/><ellipse cx="796.75" cy="1993" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M799.7188,1998.6406 Q799.1406,1998.9375 798.5,1999.0781 Q797.8594,1999.2344 797.1563,1999.2344 Q794.6563,1999.2344 793.3281,1997.5938 Q792.0156,1995.9375 792.0156,1992.8125 Q792.0156,1989.6875 793.3281,1988.0313 Q794.6563,1986.375 797.1563,1986.375 Q797.8594,1986.375 798.5,1986.5313 Q799.1563,1986.6875 799.7188,1986.9844 L799.7188,1989.7031 Q799.0938,1989.125 798.5,1988.8594 Q797.9063,1988.5781 797.2813,1988.5781 Q795.9375,1988.5781 795.25,1989.6563 Q794.5625,1990.7188 794.5625,1992.8125 Q794.5625,1994.9063 795.25,1995.9844 Q795.9375,1997.0469 797.2813,1997.0469 Q797.9063,1997.0469 798.5,1996.7813 Q799.0938,1996.5 799.7188,1995.9219 L799.7188,1998.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="817.25" y="1997.656">TextEncoder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="684.5" x2="987.5" y1="2009" y2="2009"/><ellipse cx="694.5" cy="2020" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="166" x="703.5" y="2024.7589">encode(texts: List[str]) : ndarray</text><ellipse cx="694.5" cy="2034.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="279" x="703.5" y="2039.7408">encode_batch(texts: List[str], batch_size: int) : ndarray</text><ellipse cx="694.5" cy="2049.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="703.5" y="2054.7227">get_embedding_dim() : int</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="684.5" x2="987.5" y1="2061.9457" y2="2061.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="691.5" y="2069.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="703.5" y="2077.7046">_preprocess(text: str) : str</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="691.5" y="2084.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="703.5" y="2092.6865">_tokenize(text: str) : List[int]</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="691.5" y="2099.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="703.5" y="2107.6684">_forward(tokens: Tensor) : Tensor</text><!--MD5=[4e2fed8f78c5bca99a3f3b7fd4e01e08]
class NumericWindowEncoder--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="NumericWindowEncoder" style="stroke: #A80036; stroke-width: 1.5;" width="502" x="1024" y="1977"/><ellipse cx="1201.75" cy="1993" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1204.7188,1998.6406 Q1204.1406,1998.9375 1203.5,1999.0781 Q1202.8594,1999.2344 1202.1563,1999.2344 Q1199.6563,1999.2344 1198.3281,1997.5938 Q1197.0156,1995.9375 1197.0156,1992.8125 Q1197.0156,1989.6875 1198.3281,1988.0313 Q1199.6563,1986.375 1202.1563,1986.375 Q1202.8594,1986.375 1203.5,1986.5313 Q1204.1563,1986.6875 1204.7188,1986.9844 L1204.7188,1989.7031 Q1204.0938,1989.125 1203.5,1988.8594 Q1202.9063,1988.5781 1202.2813,1988.5781 Q1200.9375,1988.5781 1200.25,1989.6563 Q1199.5625,1990.7188 1199.5625,1992.8125 Q1199.5625,1994.9063 1200.25,1995.9844 Q1200.9375,1997.0469 1202.2813,1997.0469 Q1202.9063,1997.0469 1203.5,1996.7813 Q1204.0938,1996.5 1204.7188,1995.9219 L1204.7188,1998.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="1222.25" y="1997.656">NumericWindowEncoder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1025" x2="1525" y1="2009" y2="2009"/><ellipse cx="1035" cy="2020" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="476" x="1044" y="2024.7589">embed_window(entity_type: str, entity_id: str, as_of_date: date, window_days: int) : ndarray</text><ellipse cx="1035" cy="2034.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="364" x="1044" y="2039.7408">embed_batch(entities: List[Tuple], as_of_date: date) : Dict[str, ndarray]</text><ellipse cx="1035" cy="2049.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="224" x="1044" y="2054.7227">train(data: DataFrame, epochs: int, lr: float)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025" x2="1525" y1="2061.9457" y2="2061.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1032" y="2069.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="1044" y="2077.7046">_extract_features(entity: str, window: DataFrame) : Tensor</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1032" y="2084.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="1044" y="2092.6865">_forward(features: Tensor) : Tensor</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1032" y="2099.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="1044" y="2107.6684">_compute_loss(pred: Tensor, target: Tensor) : float</text><!--MD5=[31e788e92834f145a71ad43011818d03]
class JointEncoder--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="JointEncoder" style="stroke: #A80036; stroke-width: 1.5;" width="467" x="1561.5" y="1984.5"/><ellipse cx="1755.75" cy="2000.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1758.7188,2006.1406 Q1758.1406,2006.4375 1757.5,2006.5781 Q1756.8594,2006.7344 1756.1563,2006.7344 Q1753.6563,2006.7344 1752.3281,2005.0938 Q1751.0156,2003.4375 1751.0156,2000.3125 Q1751.0156,1997.1875 1752.3281,1995.5313 Q1753.6563,1993.875 1756.1563,1993.875 Q1756.8594,1993.875 1757.5,1994.0313 Q1758.1563,1994.1875 1758.7188,1994.4844 L1758.7188,1997.2031 Q1758.0938,1996.625 1757.5,1996.3594 Q1756.9063,1996.0781 1756.2813,1996.0781 Q1754.9375,1996.0781 1754.25,1997.1563 Q1753.5625,1998.2188 1753.5625,2000.3125 Q1753.5625,2002.4063 1754.25,2003.4844 Q1754.9375,2004.5469 1756.2813,2004.5469 Q1756.9063,2004.5469 1757.5,2004.2813 Q1758.0938,2004 1758.7188,2003.4219 L1758.7188,2006.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="1776.25" y="2005.156">JointEncoder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1562.5" x2="2027.5" y1="2016.5" y2="2016.5"/><ellipse cx="1572.5" cy="2027.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="379" x="1581.5" y="2032.2589">embed_multimodal(numeric_emb: ndarray, text_emb: ndarray) : ndarray</text><ellipse cx="1572.5" cy="2042.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="1581.5" y="2047.2408">embed_regime_window(market_id: str, as_of_date: date, window_days: int) : ndarray</text><ellipse cx="1572.5" cy="2057.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="1581.5" y="2062.2227">train_contrastive(pairs: List[Tuple], epochs: int)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1562.5" x2="2027.5" y1="2069.4457" y2="2069.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1569.5" y="2077.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="268" x="1581.5" y="2085.2046">_fusion_layer(emb1: Tensor, emb2: Tensor) : Tensor</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1569.5" y="2092.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="237" x="1581.5" y="2100.1865">_project_to_joint_space(emb: Tensor) : Tensor</text><!--MD5=[096d94367fb870bbe0aa0f9957000745]
class ProfileService--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="ProfileService" style="stroke: #A80036; stroke-width: 1.5;" width="348" x="648" y="1728.5"/><ellipse cx="779.25" cy="1744.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M782.2188,1750.1406 Q781.6406,1750.4375 781,1750.5781 Q780.3594,1750.7344 779.6563,1750.7344 Q777.1563,1750.7344 775.8281,1749.0938 Q774.5156,1747.4375 774.5156,1744.3125 Q774.5156,1741.1875 775.8281,1739.5313 Q777.1563,1737.875 779.6563,1737.875 Q780.3594,1737.875 781,1738.0313 Q781.6563,1738.1875 782.2188,1738.4844 L782.2188,1741.2031 Q781.5938,1740.625 781,1740.3594 Q780.4063,1740.0781 779.7813,1740.0781 Q778.4375,1740.0781 777.75,1741.1563 Q777.0625,1742.2188 777.0625,1744.3125 Q777.0625,1746.4063 777.75,1747.4844 Q778.4375,1748.5469 779.7813,1748.5469 Q780.4063,1748.5469 781,1748.2813 Q781.5938,1748 782.2188,1747.4219 L782.2188,1750.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="799.75" y="1749.156">ProfileService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="649" x2="995" y1="1760.5" y2="1760.5"/><ellipse cx="659" cy="1771.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="312" x="668" y="1776.2589">get_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot</text><ellipse cx="659" cy="1786.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="668" y="1791.2408">build_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot</text><ellipse cx="659" cy="1801.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="275" x="668" y="1806.2227">update_profiles(issuer_ids: List[str], as_of_date: date)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="649" x2="995" y1="1813.4457" y2="1813.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="656" y="1821.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="299" x="668" y="1829.2046">_fetch_fundamentals(issuer_id: str, as_of_date: date) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="656" y="1836.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="238" x="668" y="1844.1865">_compute_risk_flags(fundamentals: Dict) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="656" y="1851.4094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="263" x="668" y="1859.1684">_embed_profile(profile: ProfileSnapshot) : ndarray</text><!--MD5=[6a668c52d4226ee7278e35bfebd01a3e]
class ProfileSnapshot--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="148.5796" id="ProfileSnapshot" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="479" y="1723"/><ellipse cx="500.3" cy="1744.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M503.2688,1749.9847 Q502.6906,1750.2816 502.05,1750.4222 Q501.4094,1750.5785 500.7063,1750.5785 Q498.2063,1750.5785 496.8781,1748.9379 Q495.5656,1747.2816 495.5656,1744.1566 Q495.5656,1741.0316 496.8781,1739.3754 Q498.2063,1737.7191 500.7063,1737.7191 Q501.4094,1737.7191 502.05,1737.8754 Q502.7063,1738.0316 503.2688,1738.3285 L503.2688,1741.0472 Q502.6438,1740.4691 502.05,1740.2035 Q501.4563,1739.9222 500.8313,1739.9222 Q499.4875,1739.9222 498.8,1741.0004 Q498.1125,1742.0629 498.1125,1744.1566 Q498.1125,1746.2504 498.8,1747.3285 Q499.4875,1748.391 500.8313,1748.391 Q501.4563,1748.391 502.05,1748.1254 Q502.6438,1747.8441 503.2688,1747.266 L503.2688,1749.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="528.7" y="1740.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="515.7" y="1757.1722">ProfileSnapshot</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="480" x2="612" y1="1765.6882" y2="1765.6882"/><ellipse cx="490" cy="1776.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="499" y="1781.4471">issuer_id: str</text><ellipse cx="490" cy="1791.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="499" y="1796.429">as_of_date: date</text><ellipse cx="490" cy="1806.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="499" y="1811.4109">structured: Dict</text><ellipse cx="490" cy="1821.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="499" y="1826.3928">embedding: ndarray</text><ellipse cx="490" cy="1836.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="499" y="1841.3747">risk_flags: Dict</text><ellipse cx="490" cy="1851.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="499" y="1856.3566">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="480" x2="612" y1="1863.5796" y2="1863.5796"/><!--MD5=[d02744c1c895cf1e22635b28104e99c0]
class ProfileBuilder--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="107.9276" id="ProfileBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="405" x="38.5" y="1743.5"/><ellipse cx="198.75" cy="1759.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M201.7188,1765.1406 Q201.1406,1765.4375 200.5,1765.5781 Q199.8594,1765.7344 199.1563,1765.7344 Q196.6563,1765.7344 195.3281,1764.0938 Q194.0156,1762.4375 194.0156,1759.3125 Q194.0156,1756.1875 195.3281,1754.5313 Q196.6563,1752.875 199.1563,1752.875 Q199.8594,1752.875 200.5,1753.0313 Q201.1563,1753.1875 201.7188,1753.4844 L201.7188,1756.2031 Q201.0938,1755.625 200.5,1755.3594 Q199.9063,1755.0781 199.2813,1755.0781 Q197.9375,1755.0781 197.25,1756.1563 Q196.5625,1757.2188 196.5625,1759.3125 Q196.5625,1761.4063 197.25,1762.4844 Q197.9375,1763.5469 199.2813,1763.5469 Q199.9063,1763.5469 200.5,1763.2813 Q201.0938,1763 201.7188,1762.4219 L201.7188,1765.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="219.25" y="1764.156">ProfileBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="442.5" y1="1775.5" y2="1775.5"/><ellipse cx="49.5" cy="1786.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="379" x="58.5" y="1791.2589">build_corporate_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot</text><ellipse cx="49.5" cy="1801.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="379" x="58.5" y="1806.2408">build_sovereign_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39.5" x2="442.5" y1="1813.4638" y2="1813.4638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46.5" y="1821.4638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="58.5" y="1829.2227">_extract_financials(issuer_id: str) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46.5" y="1836.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="58.5" y="1844.2046">_compute_ratios(financials: Dict) : Dict</text><!--MD5=[fa27d032cdb86db5a66f7a29ce59ea89]
class RegimeEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="RegimeEngine" style="stroke: #A80036; stroke-width: 1.5;" width="416" x="1592" y="1728.5"/><ellipse cx="1755.75" cy="1744.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1758.7188,1750.1406 Q1758.1406,1750.4375 1757.5,1750.5781 Q1756.8594,1750.7344 1756.1563,1750.7344 Q1753.6563,1750.7344 1752.3281,1749.0938 Q1751.0156,1747.4375 1751.0156,1744.3125 Q1751.0156,1741.1875 1752.3281,1739.5313 Q1753.6563,1737.875 1756.1563,1737.875 Q1756.8594,1737.875 1757.5,1738.0313 Q1758.1563,1738.1875 1758.7188,1738.4844 L1758.7188,1741.2031 Q1758.0938,1740.625 1757.5,1740.3594 Q1756.9063,1740.0781 1756.2813,1740.0781 Q1754.9375,1740.0781 1754.25,1741.1563 Q1753.5625,1742.2188 1753.5625,1744.3125 Q1753.5625,1746.4063 1754.25,1747.4844 Q1754.9375,1748.5469 1756.2813,1748.5469 Q1756.9063,1748.5469 1757.5,1748.2813 Q1758.0938,1748 1758.7188,1747.4219 L1758.7188,1750.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="1776.25" y="1749.156">RegimeEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1593" x2="2007" y1="1760.5" y2="1760.5"/><ellipse cx="1603" cy="1771.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="284" x="1612" y="1776.2589">get_regime(as_of_date: date, region: str) : RegimeState</text><ellipse cx="1603" cy="1786.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="390" x="1612" y="1791.2408">get_history(start_date: date, end_date: date, region: str) : List[RegimeState]</text><ellipse cx="1603" cy="1801.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="302" x="1612" y="1806.2227">get_transition_matrix(region: str) : Dict[str, Dict[str, float]]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1593" x2="2007" y1="1813.4457" y2="1813.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1600" y="1821.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="382" x="1612" y="1829.2046">_compute_window_embedding(market_id: str, as_of_date: date) : ndarray</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1600" y="1836.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="1612" y="1844.1865">_classify_regime(embedding: ndarray) : str</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1600" y="1851.4094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="323" x="1612" y="1859.1684">_compute_confidence(embedding: ndarray, regime: str) : float</text><!--MD5=[85c35e1202eac47a6da56c82d64115f1]
class RegimeState--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="148.5796" id="RegimeState" style="stroke: #A80036; stroke-width: 1.5;" width="176" x="1381" y="1723"/><ellipse cx="1429.25" cy="1744.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1432.2188,1749.9847 Q1431.6406,1750.2816 1431,1750.4222 Q1430.3594,1750.5785 1429.6563,1750.5785 Q1427.1563,1750.5785 1425.8281,1748.9379 Q1424.5156,1747.2816 1424.5156,1744.1566 Q1424.5156,1741.0316 1425.8281,1739.3754 Q1427.1563,1737.7191 1429.6563,1737.7191 Q1430.3594,1737.7191 1431,1737.8754 Q1431.6563,1738.0316 1432.2188,1738.3285 L1432.2188,1741.0472 Q1431.5938,1740.4691 1431,1740.2035 Q1430.4063,1739.9222 1429.7813,1739.9222 Q1428.4375,1739.9222 1427.75,1741.0004 Q1427.0625,1742.0629 1427.0625,1744.1566 Q1427.0625,1746.2504 1427.75,1747.3285 Q1428.4375,1748.391 1429.7813,1748.391 Q1430.4063,1748.391 1431,1748.1254 Q1431.5938,1747.8441 1432.2188,1747.266 L1432.2188,1749.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1454.25" y="1740.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="1449.75" y="1757.1722">RegimeState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1382" x2="1556" y1="1765.6882" y2="1765.6882"/><ellipse cx="1392" cy="1776.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1401" y="1781.4471">as_of_date: date</text><ellipse cx="1392" cy="1791.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="55" x="1401" y="1796.429">region: str</text><ellipse cx="1392" cy="1806.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="1401" y="1811.4109">regime_label: str</text><ellipse cx="1392" cy="1821.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="1401" y="1826.3928">regime_embedding: ndarray</text><ellipse cx="1392" cy="1836.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="1401" y="1841.3747">confidence: float</text><ellipse cx="1392" cy="1851.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1401" y="1856.3566">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1382" x2="1556" y1="1863.5796" y2="1863.5796"/><!--MD5=[5129fcfb537133ee6dc6f862e326f901]
class RegimeClassifier--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="107.9276" id="RegimeClassifier" style="stroke: #A80036; stroke-width: 1.5;" width="293" x="1052.5" y="1743.5"/><ellipse cx="1147.75" cy="1759.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1150.7188,1765.1406 Q1150.1406,1765.4375 1149.5,1765.5781 Q1148.8594,1765.7344 1148.1563,1765.7344 Q1145.6563,1765.7344 1144.3281,1764.0938 Q1143.0156,1762.4375 1143.0156,1759.3125 Q1143.0156,1756.1875 1144.3281,1754.5313 Q1145.6563,1752.875 1148.1563,1752.875 Q1148.8594,1752.875 1149.5,1753.0313 Q1150.1563,1753.1875 1150.7188,1753.4844 L1150.7188,1756.2031 Q1150.0938,1755.625 1149.5,1755.3594 Q1148.9063,1755.0781 1148.2813,1755.0781 Q1146.9375,1755.0781 1146.25,1756.1563 Q1145.5625,1757.2188 1145.5625,1759.3125 Q1145.5625,1761.4063 1146.25,1762.4844 Q1146.9375,1763.5469 1148.2813,1763.5469 Q1148.9063,1763.5469 1149.5,1763.2813 Q1150.0938,1763 1150.7188,1762.4219 L1150.7188,1765.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="1168.25" y="1764.156">RegimeClassifier</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1053.5" x2="1344.5" y1="1775.5" y2="1775.5"/><ellipse cx="1063.5" cy="1786.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="1072.5" y="1791.2589">predict(embedding: ndarray) : Tuple[str, float]</text><ellipse cx="1063.5" cy="1801.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="267" x="1072.5" y="1806.2408">train_clusters(embeddings: ndarray, n_clusters: int)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1053.5" x2="1344.5" y1="1813.4638" y2="1813.4638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1060.5" y="1821.4638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="203" x="1072.5" y="1829.2227">_kmeans_fit(X: ndarray, k: int) : KMeans</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1060.5" y="1836.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="215" x="1072.5" y="1844.2046">_assign_cluster(embedding: ndarray) : int</text><!--MD5=[0ad9605e4b6810ea897a4ff98b6f3639]
class StabilityEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="StabilityEngine" style="stroke: #A80036; stroke-width: 1.5;" width="448" x="1273" y="1459.5"/><ellipse cx="1451.75" cy="1475.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1454.7188,1481.1406 Q1454.1406,1481.4375 1453.5,1481.5781 Q1452.8594,1481.7344 1452.1563,1481.7344 Q1449.6563,1481.7344 1448.3281,1480.0938 Q1447.0156,1478.4375 1447.0156,1475.3125 Q1447.0156,1472.1875 1448.3281,1470.5313 Q1449.6563,1468.875 1452.1563,1468.875 Q1452.8594,1468.875 1453.5,1469.0313 Q1454.1563,1469.1875 1454.7188,1469.4844 L1454.7188,1472.2031 Q1454.0938,1471.625 1453.5,1471.3594 Q1452.9063,1471.0781 1452.2813,1471.0781 Q1450.9375,1471.0781 1450.25,1472.1563 Q1449.5625,1473.2188 1449.5625,1475.3125 Q1449.5625,1477.4063 1450.25,1478.4844 Q1450.9375,1479.5469 1452.2813,1479.5469 Q1452.9063,1479.5469 1453.5,1479.2813 Q1454.0938,1479 1454.7188,1478.4219 L1454.7188,1481.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82" x="1472.25" y="1480.156">StabilityEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1274" x2="1720" y1="1491.5" y2="1491.5"/><ellipse cx="1284" cy="1502.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="422" x="1293" y="1507.2589">compute_stability(entity_type: str, entity_id: str, as_of_date: date) : StabilityVector</text><ellipse cx="1284" cy="1517.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="388" x="1293" y="1522.2408">compute_soft_target_class(entity_id: str, as_of_date: date) : SoftTargetClass</text><ellipse cx="1284" cy="1532.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="398" x="1293" y="1537.2227">run_scenario_analysis(entity_id: str, scenarios: List[Scenario]) : Dict[str, float]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1274" x2="1720" y1="1544.4457" y2="1544.4457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1281" y="1552.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="1293" y="1560.2046">_compute_liquidity_score(entity_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1281" y="1567.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="328" x="1293" y="1575.1865">_compute_volatility_score(entity_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1281" y="1582.4094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="327" x="1293" y="1590.1684">_compute_contagion_risk(entity_id: str, as_of_date: date) : float</text><!--MD5=[d22884543e57f916300826d4e6eee1ce]
class StabilityVector--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="178.5433" id="StabilityVector" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="1096" y="1439"/><ellipse cx="1124.5" cy="1460.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1127.4688,1465.9847 Q1126.8906,1466.2816 1126.25,1466.4222 Q1125.6094,1466.5785 1124.9063,1466.5785 Q1122.4063,1466.5785 1121.0781,1464.9379 Q1119.7656,1463.2816 1119.7656,1460.1566 Q1119.7656,1457.0316 1121.0781,1455.3754 Q1122.4063,1453.7191 1124.9063,1453.7191 Q1125.6094,1453.7191 1126.25,1453.8754 Q1126.9063,1454.0316 1127.4688,1454.3285 L1127.4688,1457.0472 Q1126.8438,1456.4691 1126.25,1456.2035 Q1125.6563,1455.9222 1125.0313,1455.9222 Q1123.6875,1455.9222 1123,1457.0004 Q1122.3125,1458.0629 1122.3125,1460.1566 Q1122.3125,1462.2504 1123,1463.3285 Q1123.6875,1464.391 1125.0313,1464.391 Q1125.6563,1464.391 1126.25,1464.1254 Q1126.8438,1463.8441 1127.4688,1463.266 L1127.4688,1465.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1150.5" y="1456.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="1141.5" y="1473.1722">StabilityVector</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1097" x2="1237" y1="1481.6882" y2="1481.6882"/><ellipse cx="1107" cy="1492.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="1116" y="1497.4471">entity_type: str</text><ellipse cx="1107" cy="1507.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="1116" y="1512.429">entity_id: str</text><ellipse cx="1107" cy="1522.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1116" y="1527.4109">as_of_date: date</text><ellipse cx="1107" cy="1537.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1116" y="1542.3928">liquidity_score: float</text><ellipse cx="1107" cy="1552.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="1116" y="1557.3747">volatility_score: float</text><ellipse cx="1107" cy="1567.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="1116" y="1572.3566">contagion_score: float</text><ellipse cx="1107" cy="1582.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1116" y="1587.3385">overall_score: float</text><ellipse cx="1107" cy="1597.5614" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1116" y="1602.3204">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1097" x2="1237" y1="1609.5433" y2="1609.5433"/><!--MD5=[9a518c30b15aa8cca33c64d154156b6a]
class SoftTargetClass--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="178.5433" id="SoftTargetClass" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="903" y="1439"/><ellipse cx="934.65" cy="1460.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M937.6188,1465.9847 Q937.0406,1466.2816 936.4,1466.4222 Q935.7594,1466.5785 935.0563,1466.5785 Q932.5563,1466.5785 931.2281,1464.9379 Q929.9156,1463.2816 929.9156,1460.1566 Q929.9156,1457.0316 931.2281,1455.3754 Q932.5563,1453.7191 935.0563,1453.7191 Q935.7594,1453.7191 936.4,1453.8754 Q937.0563,1454.0316 937.6188,1454.3285 L937.6188,1457.0472 Q936.9938,1456.4691 936.4,1456.2035 Q935.8063,1455.9222 935.1813,1455.9222 Q933.8375,1455.9222 933.15,1457.0004 Q932.4625,1458.0629 932.4625,1460.1566 Q932.4625,1462.2504 933.15,1463.3285 Q933.8375,1464.391 935.1813,1464.391 Q935.8063,1464.391 936.4,1464.1254 Q936.9938,1463.8441 937.6188,1463.266 L937.6188,1465.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="965.85" y="1456.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="89" x="952.35" y="1473.1722">SoftTargetClass</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="904" x2="1060" y1="1481.6882" y2="1481.6882"/><ellipse cx="914" cy="1492.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="923" y="1497.4471">entity_id: str</text><ellipse cx="914" cy="1507.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="923" y="1512.429">as_of_date: date</text><ellipse cx="914" cy="1522.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="923" y="1527.4109">soft_target_class: str</text><ellipse cx="914" cy="1537.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="923" y="1542.3928">soft_target_score: float</text><ellipse cx="914" cy="1552.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="923" y="1557.3747">weak_profile: float</text><ellipse cx="914" cy="1567.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="923" y="1572.3566">instability: float</text><ellipse cx="914" cy="1582.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="923" y="1587.3385">high_fragility: float</text><ellipse cx="914" cy="1597.5614" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="923" y="1602.3204">complacent_pricing: float</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="904" x2="1060" y1="1609.5433" y2="1609.5433"/><!--MD5=[a02cc672ceeb4c9bf87fc1a7af3a6ae8]
class FragilityAlphaEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="FragilityAlphaEngine" style="stroke: #A80036; stroke-width: 1.5;" width="458" x="1190" y="1183"/><ellipse cx="1357.75" cy="1199" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1360.7188,1204.6406 Q1360.1406,1204.9375 1359.5,1205.0781 Q1358.8594,1205.2344 1358.1563,1205.2344 Q1355.6563,1205.2344 1354.3281,1203.5938 Q1353.0156,1201.9375 1353.0156,1198.8125 Q1353.0156,1195.6875 1354.3281,1194.0313 Q1355.6563,1192.375 1358.1563,1192.375 Q1358.8594,1192.375 1359.5,1192.5313 Q1360.1563,1192.6875 1360.7188,1192.9844 L1360.7188,1195.7031 Q1360.0938,1195.125 1359.5,1194.8594 Q1358.9063,1194.5781 1358.2813,1194.5781 Q1356.9375,1194.5781 1356.25,1195.6563 Q1355.5625,1196.7188 1355.5625,1198.8125 Q1355.5625,1200.9063 1356.25,1201.9844 Q1356.9375,1203.0469 1358.2813,1203.0469 Q1358.9063,1203.0469 1359.5,1202.7813 Q1360.0938,1202.5 1360.7188,1201.9219 L1360.7188,1204.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="114" x="1378.25" y="1203.656">FragilityAlphaEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1191" x2="1647" y1="1215" y2="1215"/><ellipse cx="1201" cy="1226" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="370" x="1210" y="1230.7589">compute_alpha(entity_id: str, as_of_date: date, horizon_days: int) : float</text><ellipse cx="1201" cy="1240.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="335" x="1210" y="1245.7408">compute_soft_target_score(entity_id: str, as_of_date: date) : float</text><ellipse cx="1201" cy="1255.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="380" x="1210" y="1260.7227">generate_trade_ideas(entities: List[str], as_of_date: date) : List[TradeIdea]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1191" x2="1647" y1="1267.9457" y2="1267.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1198" y="1275.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="317" x="1210" y="1283.7046">_compute_weak_profile(entity_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1198" y="1290.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="352" x="1210" y="1298.6865">_compute_complacent_pricing(entity_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1198" y="1305.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="432" x="1210" y="1313.6684">_combine_signals(profile: float, instability: float, fragility: float, pricing: float) : float</text><!--MD5=[6c4f99d332a9a835265d360c310afb7d]
class TradeIdea--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="163.5614" id="TradeIdea" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="1013" y="1170"/><ellipse cx="1051.4" cy="1191.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1054.3688,1196.9847 Q1053.7906,1197.2816 1053.15,1197.4222 Q1052.5094,1197.5785 1051.8063,1197.5785 Q1049.3063,1197.5785 1047.9781,1195.9379 Q1046.6656,1194.2816 1046.6656,1191.1566 Q1046.6656,1188.0316 1047.9781,1186.3754 Q1049.3063,1184.7191 1051.8063,1184.7191 Q1052.5094,1184.7191 1053.15,1184.8754 Q1053.8063,1185.0316 1054.3688,1185.3285 L1054.3688,1188.0472 Q1053.7438,1187.4691 1053.15,1187.2035 Q1052.5563,1186.9222 1051.9313,1186.9222 Q1050.5875,1186.9222 1049.9,1188.0004 Q1049.2125,1189.0629 1049.2125,1191.1566 Q1049.2125,1193.2504 1049.9,1194.3285 Q1050.5875,1195.391 1051.9313,1195.391 Q1052.5563,1195.391 1053.15,1195.1254 Q1053.7438,1194.8441 1054.3688,1194.266 L1054.3688,1196.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1068.6" y="1187.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="58" x="1070.6" y="1204.1722">TradeIdea</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1014" x2="1154" y1="1212.6882" y2="1212.6882"/><ellipse cx="1024" cy="1223.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="1033" y="1228.4471">entity_id: str</text><ellipse cx="1024" cy="1238.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="1033" y="1243.429">instrument_id: str</text><ellipse cx="1024" cy="1253.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="1033" y="1258.4109">direction: str</text><ellipse cx="1024" cy="1268.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="1033" y="1273.3928">trade_type: str</text><ellipse cx="1024" cy="1283.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="1033" y="1288.3747">expected_payoff: float</text><ellipse cx="1024" cy="1298.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="1033" y="1303.3566">confidence: float</text><ellipse cx="1024" cy="1313.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="1033" y="1318.3385">rationale: str</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1014" x2="1154" y1="1325.5614" y2="1325.5614"/><!--MD5=[a5ed68bac9d003822bfd078a6bf74a60]
class AssessmentEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="AssessmentEngine" style="stroke: #A80036; stroke-width: 1.5;" width="727" x="1354.5" y="899"/><ellipse cx="1660.75" cy="915" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1663.7188,920.6406 Q1663.1406,920.9375 1662.5,921.0781 Q1661.8594,921.2344 1661.1563,921.2344 Q1658.6563,921.2344 1657.3281,919.5938 Q1656.0156,917.9375 1656.0156,914.8125 Q1656.0156,911.6875 1657.3281,910.0313 Q1658.6563,908.375 1661.1563,908.375 Q1661.8594,908.375 1662.5,908.5313 Q1663.1563,908.6875 1663.7188,908.9844 L1663.7188,911.7031 Q1663.0938,911.125 1662.5,910.8594 Q1661.9063,910.5781 1661.2813,910.5781 Q1659.9375,910.5781 1659.25,911.6563 Q1658.5625,912.7188 1658.5625,914.8125 Q1658.5625,916.9063 1659.25,917.9844 Q1659.9375,919.0469 1661.2813,919.0469 Q1661.9063,919.0469 1662.5,918.7813 Q1663.0938,918.5 1663.7188,917.9219 L1663.7188,920.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="1681.25" y="919.656">AssessmentEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1355.5" x2="2080.5" y1="931" y2="931"/><ellipse cx="1365.5" cy="942" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="701" x="1374.5" y="946.7589">score_universe(strategy_id: str, market_id: str, instrument_ids: List[str], as_of_date: date, horizon_days: int) : Dict[str, InstrumentScore]</text><ellipse cx="1365.5" cy="956.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="515" x="1374.5" y="961.7408">score_strategy_default(strategy_id: str, market_id: str, as_of_date: date) : Dict[str, InstrumentScore]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1355.5" x2="2080.5" y1="968.9638" y2="968.9638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1362.5" y="976.9638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="340" x="1374.5" y="984.7227">_compute_value_alpha(instrument_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1362.5" y="991.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="373" x="1374.5" y="999.7046">_compute_momentum_alpha(instrument_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1362.5" y="1006.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="348" x="1374.5" y="1014.6865">_compute_quality_alpha(instrument_id: str, as_of_date: date) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1362.5" y="1021.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="354" x="1374.5" y="1029.6684">_combine_alphas(alphas: Dict[str, float], regime: RegimeState) : float</text><!--MD5=[6b3a07d8c2739f8c24b0092e3ca33740]
class InstrumentScore--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="193.5252" id="InstrumentScore" style="stroke: #A80036; stroke-width: 1.5;" width="203" x="1116.5" y="871"/><ellipse cx="1166.75" cy="892.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1169.7188,897.9847 Q1169.1406,898.2816 1168.5,898.4222 Q1167.8594,898.5785 1167.1563,898.5785 Q1164.6563,898.5785 1163.3281,896.9379 Q1162.0156,895.2816 1162.0156,892.1566 Q1162.0156,889.0316 1163.3281,887.3754 Q1164.6563,885.7191 1167.1563,885.7191 Q1167.8594,885.7191 1168.5,885.8754 Q1169.1563,886.0316 1169.7188,886.3285 L1169.7188,889.0472 Q1169.0938,888.4691 1168.5,888.2035 Q1167.9063,887.9222 1167.2813,887.9222 Q1165.9375,887.9222 1165.25,889.0004 Q1164.5625,890.0629 1164.5625,892.1566 Q1164.5625,894.2504 1165.25,895.3285 Q1165.9375,896.391 1167.2813,896.391 Q1167.9063,896.391 1168.5,896.1254 Q1169.0938,895.8441 1169.7188,895.266 L1169.7188,897.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1203.25" y="888.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="1187.25" y="905.1722">InstrumentScore</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1117.5" x2="1318.5" y1="913.6882" y2="913.6882"/><ellipse cx="1127.5" cy="924.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="1136.5" y="929.4471">instrument_id: str</text><ellipse cx="1127.5" cy="939.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1136.5" y="944.429">as_of_date: date</text><ellipse cx="1127.5" cy="954.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="1136.5" y="959.4109">horizon_days: int</text><ellipse cx="1127.5" cy="969.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="1136.5" y="974.3928">expected_return: float</text><ellipse cx="1127.5" cy="984.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="1136.5" y="989.3747">score: float</text><ellipse cx="1127.5" cy="999.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="1136.5" y="1004.3566">confidence: float</text><ellipse cx="1127.5" cy="1014.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="1136.5" y="1019.3385">signal_label: str</text><ellipse cx="1127.5" cy="1029.5614" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="1136.5" y="1034.3204">alpha_components: Dict[str, float]</text><ellipse cx="1127.5" cy="1044.5433" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1136.5" y="1049.3022">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1117.5" x2="1318.5" y1="1056.5252" y2="1056.5252"/><!--MD5=[9a0ab0dd8d8ce96eb3efff9bea275655]
class UniverseEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="UniverseEngine" style="stroke: #A80036; stroke-width: 1.5;" width="386" x="1525" y="615"/><ellipse cx="1669.75" cy="631" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1672.7188,636.6406 Q1672.1406,636.9375 1671.5,637.0781 Q1670.8594,637.2344 1670.1563,637.2344 Q1667.6563,637.2344 1666.3281,635.5938 Q1665.0156,633.9375 1665.0156,630.8125 Q1665.0156,627.6875 1666.3281,626.0313 Q1667.6563,624.375 1670.1563,624.375 Q1670.8594,624.375 1671.5,624.5313 Q1672.1563,624.6875 1672.7188,624.9844 L1672.7188,627.7031 Q1672.0938,627.125 1671.5,626.8594 Q1670.9063,626.5781 1670.2813,626.5781 Q1668.9375,626.5781 1668.25,627.6563 Q1667.5625,628.7188 1667.5625,630.8125 Q1667.5625,632.9063 1668.25,633.9844 Q1668.9375,635.0469 1670.2813,635.0469 Q1670.9063,635.0469 1671.5,634.7813 Q1672.0938,634.5 1672.7188,633.9219 L1672.7188,636.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="1690.25" y="635.656">UniverseEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1526" x2="1910" y1="647" y2="647"/><ellipse cx="1536" cy="658" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="336" x="1545" y="662.7589">select(strategy_id: str, market_id: str, as_of_date: date) : Universe</text><ellipse cx="1536" cy="672.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="355" x="1545" y="677.7408">filter_by_liquidity(instruments: List[str], min_volume: float) : List[str]</text><ellipse cx="1536" cy="687.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="360" x="1545" y="692.7227">filter_by_constraints(instruments: List[str], constraints: Dict) : List[str]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1526" x2="1910" y1="699.9457" y2="699.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1533" y="707.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="1545" y="715.7046">_apply_core_filters(instruments: List[str]) : List[str]</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1533" y="722.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="1545" y="730.6865">_rank_by_scores(instruments: List[str], scores: Dict) : List[str]</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1533" y="737.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="331" x="1545" y="745.6684">_assign_tiers(ranked: List[str], tier_sizes: Dict) : Dict[str, List[str]]</text><!--MD5=[bbdc91343f2bf90fe65732896edbb054]
class Universe--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="163.5614" id="Universe" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1372" y="602"/><ellipse cx="1399.6" cy="623.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1402.5688,628.9847 Q1401.9906,629.2816 1401.35,629.4222 Q1400.7094,629.5785 1400.0063,629.5785 Q1397.5063,629.5785 1396.1781,627.9379 Q1394.8656,626.2816 1394.8656,623.1566 Q1394.8656,620.0316 1396.1781,618.3754 Q1397.5063,616.7191 1400.0063,616.7191 Q1400.7094,616.7191 1401.35,616.8754 Q1402.0063,617.0316 1402.5688,617.3285 L1402.5688,620.0472 Q1401.9438,619.4691 1401.35,619.2035 Q1400.7563,618.9222 1400.1313,618.9222 Q1398.7875,618.9222 1398.1,620.0004 Q1397.4125,621.0629 1397.4125,623.1566 Q1397.4125,625.2504 1398.1,626.3285 Q1398.7875,627.391 1400.1313,627.391 Q1400.7563,627.391 1401.35,627.1254 Q1401.9438,626.8441 1402.5688,626.266 L1402.5688,628.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1414.4" y="619.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="1420.4" y="636.1722">Universe</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1373" x2="1489" y1="644.6882" y2="644.6882"/><ellipse cx="1383" cy="655.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="1392" y="660.4471">strategy_id: str</text><ellipse cx="1383" cy="670.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="1392" y="675.429">market_id: str</text><ellipse cx="1383" cy="685.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1392" y="690.4109">as_of_date: date</text><ellipse cx="1383" cy="700.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="1392" y="705.3928">core: List[str]</text><ellipse cx="1383" cy="715.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="1392" y="720.3747">satellite: List[str]</text><ellipse cx="1383" cy="730.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="1392" y="735.3566">watchlist: List[str]</text><ellipse cx="1383" cy="745.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1392" y="750.3385">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1373" x2="1489" y1="757.5614" y2="757.5614"/><!--MD5=[519d22ff033f8f985a134d415ff68474]
class PortfolioEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="PortfolioEngine" style="stroke: #A80036; stroke-width: 1.5;" width="610" x="1670" y="331"/><ellipse cx="1928.25" cy="347" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1931.2188,352.6406 Q1930.6406,352.9375 1930,353.0781 Q1929.3594,353.2344 1928.6563,353.2344 Q1926.1563,353.2344 1924.8281,351.5938 Q1923.5156,349.9375 1923.5156,346.8125 Q1923.5156,343.6875 1924.8281,342.0313 Q1926.1563,340.375 1928.6563,340.375 Q1929.3594,340.375 1930,340.5313 Q1930.6563,340.6875 1931.2188,340.9844 L1931.2188,343.7031 Q1930.5938,343.125 1930,342.8594 Q1929.4063,342.5781 1928.7813,342.5781 Q1927.4375,342.5781 1926.75,343.6563 Q1926.0625,344.7188 1926.0625,346.8125 Q1926.0625,348.9063 1926.75,349.9844 Q1927.4375,351.0469 1928.7813,351.0469 Q1929.4063,351.0469 1930,350.7813 Q1930.5938,350.5 1931.2188,349.9219 L1931.2188,352.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1948.75" y="351.656">PortfolioEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1671" x2="2279" y1="363" y2="363"/><ellipse cx="1681" cy="374" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="584" x="1690" y="378.7589">optimize(strategy_id: str, as_of_date: date, universe: Universe, scores: Dict[str, InstrumentScore]) : Dict[str, float]</text><ellipse cx="1681" cy="388.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="353" x="1690" y="393.7408">compute_risk_report(portfolio_id: str, as_of_date: date) : RiskReport</text><ellipse cx="1681" cy="403.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="415" x="1690" y="408.7227">run_scenario_analysis(portfolio_id: str, scenarios: List[Scenario]) : Dict[str, float]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1671" x2="2279" y1="415.9457" y2="415.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1678" y="423.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="479" x="1690" y="431.7046">_build_optimization_problem(universe: List[str], scores: Dict, constraints: Dict) : OptProblem</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1678" y="438.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="240" x="1690" y="446.6865">_solve_cvxpy(problem: OptProblem) : ndarray</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1678" y="453.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="312" x="1690" y="461.6684">_validate_solution(weights: ndarray, constraints: Dict) : bool</text><!--MD5=[a7952d38fe76afd8c6f3777011caafac]
class RiskReport--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="193.5252" id="RiskReport" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="1473.5" y="303"/><ellipse cx="1520.25" cy="324.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1523.2188,329.9847 Q1522.6406,330.2816 1522,330.4222 Q1521.3594,330.5785 1520.6563,330.5785 Q1518.1563,330.5785 1516.8281,328.9379 Q1515.5156,327.2816 1515.5156,324.1566 Q1515.5156,321.0316 1516.8281,319.3754 Q1518.1563,317.7191 1520.6563,317.7191 Q1521.3594,317.7191 1522,317.8754 Q1522.6563,318.0316 1523.2188,318.3285 L1523.2188,321.0472 Q1522.5938,320.4691 1522,320.2035 Q1521.4063,319.9222 1520.7813,319.9222 Q1519.4375,319.9222 1518.75,321.0004 Q1518.0625,322.0629 1518.0625,324.1566 Q1518.0625,326.2504 1518.75,327.3285 Q1519.4375,328.391 1520.7813,328.391 Q1521.4063,328.391 1522,328.1254 Q1522.5938,327.8441 1523.2188,327.266 L1523.2188,329.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1539.25" y="320.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="59" x="1540.75" y="337.1722">RiskReport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1474.5" x2="1633.5" y1="345.6882" y2="345.6882"/><ellipse cx="1484.5" cy="356.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="1493.5" y="361.4471">portfolio_id: str</text><ellipse cx="1484.5" cy="371.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1493.5" y="376.429">as_of_date: date</text><ellipse cx="1484.5" cy="386.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="1493.5" y="391.4109">portfolio_value: float</text><ellipse cx="1484.5" cy="401.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="1493.5" y="406.3928">net_exposure: float</text><ellipse cx="1484.5" cy="416.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="1493.5" y="421.3747">gross_exposure: float</text><ellipse cx="1484.5" cy="431.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1493.5" y="436.3566">leverage: float</text><ellipse cx="1484.5" cy="446.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="88" x="1493.5" y="451.3385">risk_metrics: Dict</text><ellipse cx="1484.5" cy="461.5614" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="92" x="1493.5" y="466.3204">scenario_pnl: Dict</text><ellipse cx="1484.5" cy="476.5433" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="1493.5" y="481.3022">exposures_by_sector: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1474.5" x2="1633.5" y1="488.5252" y2="488.5252"/><!--MD5=[8dcd8e5e0864eea8655a574c9c612f42]
class ScenarioEngine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="ScenarioEngine" style="stroke: #A80036; stroke-width: 1.5;" width="655" x="2139.5" y="622.5"/><ellipse cx="2419.25" cy="638.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2422.2188,644.1406 Q2421.6406,644.4375 2421,644.5781 Q2420.3594,644.7344 2419.6563,644.7344 Q2417.1563,644.7344 2415.8281,643.0938 Q2414.5156,641.4375 2414.5156,638.3125 Q2414.5156,635.1875 2415.8281,633.5313 Q2417.1563,631.875 2419.6563,631.875 Q2420.3594,631.875 2421,632.0313 Q2421.6563,632.1875 2422.2188,632.4844 L2422.2188,635.2031 Q2421.5938,634.625 2421,634.3594 Q2420.4063,634.0781 2419.7813,634.0781 Q2418.4375,634.0781 2417.75,635.1563 Q2417.0625,636.2188 2417.0625,638.3125 Q2417.0625,640.4063 2417.75,641.4844 Q2418.4375,642.5469 2419.7813,642.5469 Q2420.4063,642.5469 2421,642.2813 Q2421.5938,642 2422.2188,641.4219 L2422.2188,644.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="2439.75" y="643.156">ScenarioEngine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2140.5" x2="2793.5" y1="654.5" y2="654.5"/><ellipse cx="2150.5" cy="665.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="427" x="2159.5" y="670.2589">generate_scenarios(scenario_type: str, n_scenarios: int, params: Dict) : ScenarioSet</text><ellipse cx="2150.5" cy="680.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="629" x="2159.5" y="685.2408">simulate_paths(instrument_ids: List[str], start_date: date, end_date: date, scenario_set: ScenarioSet) : Dict[str, DataFrame]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2140.5" x2="2793.5" y1="692.4638" y2="692.4638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2147.5" y="700.4638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="278" x="2159.5" y="708.2227">_calibrate_model(historical_returns: DataFrame) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2147.5" y="715.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="291" x="2159.5" y="723.2046">_sample_shocks(n_scenarios: int, params: Dict) : ndarray</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2147.5" y="730.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="2159.5" y="738.1865">_generate_path(instrument_id: str, shocks: ndarray) : Series</text><!--MD5=[1612921630666a443cc1c2efb763fdf0]
class ScenarioSet--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="148.5796" id="ScenarioSet" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="1967.5" y="609.5"/><ellipse cx="1999.6" cy="630.8441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2002.5688,636.4847 Q2001.9906,636.7816 2001.35,636.9222 Q2000.7094,637.0785 2000.0063,637.0785 Q1997.5063,637.0785 1996.1781,635.4379 Q1994.8656,633.7816 1994.8656,630.6566 Q1994.8656,627.5316 1996.1781,625.8754 Q1997.5063,624.2191 2000.0063,624.2191 Q2000.7094,624.2191 2001.35,624.3754 Q2002.0063,624.5316 2002.5688,624.8285 L2002.5688,627.5472 Q2001.9438,626.9691 2001.35,626.7035 Q2000.7563,626.4222 2000.1313,626.4222 Q1998.7875,626.4222 1998.1,627.5004 Q1997.4125,628.5629 1997.4125,630.6566 Q1997.4125,632.7504 1998.1,633.8285 Q1998.7875,634.891 2000.1313,634.891 Q2000.7563,634.891 2001.35,634.6254 Q2001.9438,634.3441 2002.5688,633.766 L2002.5688,636.4847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="2019.9" y="627.3281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="2017.4" y="643.6722">ScenarioSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1968.5" x2="2103.5" y1="652.1882" y2="652.1882"/><ellipse cx="1978.5" cy="663.1882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1987.5" y="667.9471">scenario_set_id: str</text><ellipse cx="1978.5" cy="678.1701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1987.5" y="682.929">set_type: str</text><ellipse cx="1978.5" cy="693.152" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="1987.5" y="697.9109">generated_date: date</text><ellipse cx="1978.5" cy="708.1339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="1987.5" y="712.8928">n_scenarios: int</text><ellipse cx="1978.5" cy="723.1158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="1987.5" y="727.8747">params: Dict</text><ellipse cx="1978.5" cy="738.0977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1987.5" y="742.8566">metadata: Dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1968.5" x2="2103.5" y1="750.0796" y2="750.0796"/><!--MD5=[faf916e71fd440293c3643afe62595cf]
class BrokerInterface--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="152.8732" id="BrokerInterface" style="stroke: #A80036; stroke-width: 1.5;" width="234" x="2337" y="323.5"/><ellipse cx="2407.75" cy="339.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2403.6719,335.2656 L2403.6719,333.1094 L2411.0625,333.1094 L2411.0625,335.2656 L2408.5938,335.2656 L2408.5938,343.3438 L2411.0625,343.3438 L2411.0625,345.5 L2403.6719,345.5 L2403.6719,343.3438 L2406.1406,343.3438 L2406.1406,335.2656 L2403.6719,335.2656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="2428.25" y="344.156">BrokerInterface</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2338" x2="2570" y1="355.5" y2="355.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="2338" x2="2570" y1="363.5" y2="363.5"/><ellipse cx="2348" cy="374.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="149" x="2357" y="379.2589">submit_order(order: Order) : str</text><ellipse cx="2348" cy="389.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="152" x="2357" y="394.2408">cancel_order(order_id: str) : bool</text><ellipse cx="2348" cy="404.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="208" x="2357" y="409.2227">get_order_status(order_id: str) : OrderStatus</text><ellipse cx="2348" cy="419.4457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="162" x="2357" y="424.2046">get_fills(since: datetime) : List[Fill]</text><ellipse cx="2348" cy="434.4276" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="161" x="2357" y="439.1865">get_positions() : Dict[str, Position]</text><ellipse cx="2348" cy="449.4094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="119" x="2357" y="454.1684">get_account_state() : Dict</text><ellipse cx="2348" cy="464.3913" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="27" x="2357" y="469.1502">sync()</text><!--MD5=[7c0f15e9fdbba407c96d8710374efcfb]
class LiveBroker--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="LiveBroker" style="stroke: #A80036; stroke-width: 1.5;" width="238" x="2768" y="62"/><ellipse cx="2852.75" cy="78" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2855.7188,83.6406 Q2855.1406,83.9375 2854.5,84.0781 Q2853.8594,84.2344 2853.1563,84.2344 Q2850.6563,84.2344 2849.3281,82.5938 Q2848.0156,80.9375 2848.0156,77.8125 Q2848.0156,74.6875 2849.3281,73.0313 Q2850.6563,71.375 2853.1563,71.375 Q2853.8594,71.375 2854.5,71.5313 Q2855.1563,71.6875 2855.7188,71.9844 L2855.7188,74.7031 Q2855.0938,74.125 2854.5,73.8594 Q2853.9063,73.5781 2853.2813,73.5781 Q2851.9375,73.5781 2851.25,74.6563 Q2850.5625,75.7188 2850.5625,77.8125 Q2850.5625,79.9063 2851.25,80.9844 Q2851.9375,82.0469 2853.2813,82.0469 Q2853.9063,82.0469 2854.5,81.7813 Q2855.0938,81.5 2855.7188,80.9219 L2855.7188,83.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="2873.25" y="82.656">LiveBroker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2769" x2="3005" y1="94" y2="94"/><ellipse cx="2779" cy="105" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="2788" y="109.7589">submit_order(order: Order) : str</text><ellipse cx="2779" cy="119.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="171" x="2788" y="124.7408">cancel_order(order_id: str) : bool</text><ellipse cx="2779" cy="134.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="2788" y="139.7227">get_positions() : Dict[str, Position]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2769" x2="3005" y1="146.9457" y2="146.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2776" y="154.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="2788" y="162.7046">_connect_ibkr() : IB</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2776" y="169.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="2788" y="177.6865">_translate_order(order: Order) : IBOrder</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2776" y="184.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="2788" y="192.6684">_handle_fill_event(fill: IBFill)</text><!--MD5=[84b1569f6272ebd85f76973883be2adf]
class BacktestBroker--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="BacktestBroker" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="3041" y="62"/><ellipse cx="3099.75" cy="78" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M3102.7188,83.6406 Q3102.1406,83.9375 3101.5,84.0781 Q3100.8594,84.2344 3100.1563,84.2344 Q3097.6563,84.2344 3096.3281,82.5938 Q3095.0156,80.9375 3095.0156,77.8125 Q3095.0156,74.6875 3096.3281,73.0313 Q3097.6563,71.375 3100.1563,71.375 Q3100.8594,71.375 3101.5,71.5313 Q3102.1563,71.6875 3102.7188,71.9844 L3102.7188,74.7031 Q3102.0938,74.125 3101.5,73.8594 Q3100.9063,73.5781 3100.2813,73.5781 Q3098.9375,73.5781 3098.25,74.6563 Q3097.5625,75.7188 3097.5625,77.8125 Q3097.5625,79.9063 3098.25,80.9844 Q3098.9375,82.0469 3100.2813,82.0469 Q3100.9063,82.0469 3101.5,81.7813 Q3102.0938,81.5 3102.7188,80.9219 L3102.7188,83.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="3120.25" y="82.656">BacktestBroker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="3042" x2="3252" y1="94" y2="94"/><ellipse cx="3052" cy="105" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="3061" y="109.7589">submit_order(order: Order) : str</text><ellipse cx="3052" cy="119.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="3061" y="124.7408">process_fills(as_of_date: date)</text><ellipse cx="3052" cy="134.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="3061" y="139.7227">get_positions() : Dict[str, Position]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="3042" x2="3252" y1="146.9457" y2="146.9457"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3049" y="154.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="3061" y="162.7046">market_simulator: MarketSimulator</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3049" y="169.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="3061" y="177.6865">time_machine: TimeMachine</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3049" y="184.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="3061" y="192.6684">pending_orders: List[Order]</text><!--MD5=[82c88e3d3c02a0f19a00b668d7338403]
class MarketSimulator--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="107.9276" id="MarketSimulator" style="stroke: #A80036; stroke-width: 1.5;" width="344" x="2606" y="346"/><ellipse cx="2726.75" cy="362" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2729.7188,367.6406 Q2729.1406,367.9375 2728.5,368.0781 Q2727.8594,368.2344 2727.1563,368.2344 Q2724.6563,368.2344 2723.3281,366.5938 Q2722.0156,364.9375 2722.0156,361.8125 Q2722.0156,358.6875 2723.3281,357.0313 Q2724.6563,355.375 2727.1563,355.375 Q2727.8594,355.375 2728.5,355.5313 Q2729.1563,355.6875 2729.7188,355.9844 L2729.7188,358.7031 Q2729.0938,358.125 2728.5,357.8594 Q2727.9063,357.5781 2727.2813,357.5781 Q2725.9375,357.5781 2725.25,358.6563 Q2724.5625,359.7188 2724.5625,361.8125 Q2724.5625,363.9063 2725.25,364.9844 Q2725.9375,366.0469 2727.2813,366.0469 Q2727.9063,366.0469 2728.5,365.7813 Q2729.0938,365.5 2729.7188,364.9219 L2729.7188,367.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="2747.25" y="366.656">MarketSimulator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2607" x2="2949" y1="378" y2="378"/><ellipse cx="2617" cy="389" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="250" x="2626" y="393.7589">simulate_fill(order: Order, as_of_date: date) : Fill</text><ellipse cx="2617" cy="403.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="2626" y="408.7408">get_fill_price(order: Order, prices: DataFrame) : float</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2607" x2="2949" y1="415.9638" y2="415.9638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2614" y="423.9638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="252" x="2626" y="431.7227">_apply_slippage(price: float, order: Order) : float</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2614" y="438.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="2626" y="446.7046">_check_volume_constraint(order: Order, volume: float) : bool</text><!--MD5=[e7801714fce25d4474fb5c03878e8b83]
class TimeMachine--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="122.9094" id="TimeMachine" style="stroke: #A80036; stroke-width: 1.5;" width="267" x="2985.5" y="338.5"/><ellipse cx="3076.75" cy="354.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M3079.7188,360.1406 Q3079.1406,360.4375 3078.5,360.5781 Q3077.8594,360.7344 3077.1563,360.7344 Q3074.6563,360.7344 3073.3281,359.0938 Q3072.0156,357.4375 3072.0156,354.3125 Q3072.0156,351.1875 3073.3281,349.5313 Q3074.6563,347.875 3077.1563,347.875 Q3077.8594,347.875 3078.5,348.0313 Q3079.1563,348.1875 3079.7188,348.4844 L3079.7188,351.2031 Q3079.0938,350.625 3078.5,350.3594 Q3077.9063,350.0781 3077.2813,350.0781 Q3075.9375,350.0781 3075.25,351.1563 Q3074.5625,352.2188 3074.5625,354.3125 Q3074.5625,356.4063 3075.25,357.4844 Q3075.9375,358.5469 3077.2813,358.5469 Q3077.9063,358.5469 3078.5,358.2813 Q3079.0938,358 3079.7188,357.4219 L3079.7188,360.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="3097.25" y="359.156">TimeMachine</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2986.5" x2="3251.5" y1="370.5" y2="370.5"/><ellipse cx="2996.5" cy="381.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="3005.5" y="386.2589">set_date(as_of_date: date)</text><ellipse cx="2996.5" cy="396.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="225" x="3005.5" y="401.2408">get_data(table: str, filters: Dict) : DataFrame</text><ellipse cx="2996.5" cy="411.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="3005.5" y="416.2227">iter_trading_days() : Iterator[date]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2986.5" x2="3251.5" y1="423.4457" y2="423.4457"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2993.5" y="431.4457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="3005.5" y="439.2046">current_date: date</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2993.5" y="446.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="3005.5" y="454.1865">_validate_no_lookahead(requested_date: date)</text><!--MD5=[430fea09b88008e5fd775dd8402ec1b2]
class OrderPlanner--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="92.9457" id="OrderPlanner" style="stroke: #A80036; stroke-width: 1.5;" width="397" x="2335.5" y="84.5"/><ellipse cx="2491.75" cy="100.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2494.7188,106.1406 Q2494.1406,106.4375 2493.5,106.5781 Q2492.8594,106.7344 2492.1563,106.7344 Q2489.6563,106.7344 2488.3281,105.0938 Q2487.0156,103.4375 2487.0156,100.3125 Q2487.0156,97.1875 2488.3281,95.5313 Q2489.6563,93.875 2492.1563,93.875 Q2492.8594,93.875 2493.5,94.0313 Q2494.1563,94.1875 2494.7188,94.4844 L2494.7188,97.2031 Q2494.0938,96.625 2493.5,96.3594 Q2492.9063,96.0781 2492.2813,96.0781 Q2490.9375,96.0781 2490.25,97.1563 Q2489.5625,98.2188 2489.5625,100.3125 Q2489.5625,102.4063 2490.25,103.4844 Q2490.9375,104.5469 2492.2813,104.5469 Q2492.9063,104.5469 2493.5,104.2813 Q2494.0938,104 2494.7188,103.4219 L2494.7188,106.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="2512.25" y="105.156">OrderPlanner</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="2336.5" x2="2731.5" y1="116.5" y2="116.5"/><ellipse cx="2346.5" cy="127.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="371" x="2355.5" y="132.2589">plan_orders(current_positions: Dict, target_positions: Dict) : List[Order]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2336.5" x2="2731.5" y1="139.4819" y2="139.4819"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2343.5" y="147.4819"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="251" x="2355.5" y="155.2408">_compute_deltas(current: Dict, target: Dict) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="2343.5" y="162.4638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="2355.5" y="170.2227">_split_large_orders(order: Order, max_size: float) : List[Order]</text><!--MD5=[bdd50387d910629b8adcc6244c64ba59]
class MetaOrchestrator--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="152.8732" id="MetaOrchestrator" style="stroke: #A80036; stroke-width: 1.5;" width="627" x="1292.5" y="2225.5"/><ellipse cx="1551.25" cy="2241.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1554.2188,2247.1406 Q1553.6406,2247.4375 1553,2247.5781 Q1552.3594,2247.7344 1551.6563,2247.7344 Q1549.1563,2247.7344 1547.8281,2246.0938 Q1546.5156,2244.4375 1546.5156,2241.3125 Q1546.5156,2238.1875 1547.8281,2236.5313 Q1549.1563,2234.875 1551.6563,2234.875 Q1552.3594,2234.875 1553,2235.0313 Q1553.6563,2235.1875 1554.2188,2235.4844 L1554.2188,2238.2031 Q1553.5938,2237.625 1553,2237.3594 Q1552.4063,2237.0781 1551.7813,2237.0781 Q1550.4375,2237.0781 1549.75,2238.1563 Q1549.0625,2239.2188 1549.0625,2241.3125 Q1549.0625,2243.4063 1549.75,2244.4844 Q1550.4375,2245.5469 1551.7813,2245.5469 Q1552.4063,2245.5469 1553,2245.2813 Q1553.5938,2245 1554.2188,2244.4219 L1554.2188,2247.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="1571.75" y="2246.156">MetaOrchestrator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1293.5" x2="1918.5" y1="2257.5" y2="2257.5"/><ellipse cx="1303.5" cy="2268.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="542" x="1312.5" y="2273.2589">engine_performance(engine_name: str, config_id: str, start: date, end: date) : EnginePerformanceReport</text><ellipse cx="1303.5" cy="2283.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="601" x="1312.5" y="2288.2408">compare_configs(engine_name: str, config_ids: List[str], start: date, end: date) : Dict[str, EnginePerformanceReport]</text><ellipse cx="1303.5" cy="2298.4638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="471" x="1312.5" y="2303.2227">create_experiment(engine_name: str, base_config: str, proposed_config: Dict) : Experiment</text><ellipse cx="1303.5" cy="2313.4457" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="302" x="1312.5" y="2318.2046">experiment_results(experiment_id: str) : ExperimentResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="1918.5" y1="2325.4276" y2="2325.4276"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1300.5" y="2333.4276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="435" x="1312.5" y="2341.1865">_aggregate_decisions(engine: str, config: str, period: Tuple[date, date]) : DataFrame</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1300.5" y="2348.4094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="360" x="1312.5" y="2356.1684">_compute_metrics(decisions: DataFrame, outcomes: DataFrame) : Dict</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1300.5" y="2363.3913"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="429" x="1312.5" y="2371.1502">_slice_by_regime(decisions: DataFrame, regimes: DataFrame) : Dict[str, DataFrame]</text><!--MD5=[3ff35640c40147eafbc1356da99d7411]
class EnginePerformanceReport--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="163.5614" id="EnginePerformanceReport" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="1078" y="2220"/><ellipse cx="1093" cy="2241.3441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1095.9688,2246.9847 Q1095.3906,2247.2816 1094.75,2247.4222 Q1094.1094,2247.5785 1093.4063,2247.5785 Q1090.9063,2247.5785 1089.5781,2245.9379 Q1088.2656,2244.2816 1088.2656,2241.1566 Q1088.2656,2238.0316 1089.5781,2236.3754 Q1090.9063,2234.7191 1093.4063,2234.7191 Q1094.1094,2234.7191 1094.75,2234.8754 Q1095.4063,2235.0316 1095.9688,2235.3285 L1095.9688,2238.0472 Q1095.3438,2237.4691 1094.75,2237.2035 Q1094.1563,2236.9222 1093.5313,2236.9222 Q1092.1875,2236.9222 1091.5,2238.0004 Q1090.8125,2239.0629 1090.8125,2241.1566 Q1090.8125,2243.2504 1091.5,2244.3285 Q1092.1875,2245.391 1093.5313,2245.391 Q1094.1563,2245.391 1094.75,2245.1254 Q1095.3438,2244.8441 1095.9688,2244.266 L1095.9688,2246.9847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="1150" y="2237.8281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="1107" y="2254.1722">EnginePerformanceReport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1079" x2="1257" y1="2262.6882" y2="2262.6882"/><ellipse cx="1089" cy="2273.6882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="1098" y="2278.4471">engine_name: str</text><ellipse cx="1089" cy="2288.6701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="1098" y="2293.429">config_id: str</text><ellipse cx="1089" cy="2303.652" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="1098" y="2308.4109">period_start: date</text><ellipse cx="1089" cy="2318.6339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="1098" y="2323.3928">period_end: date</text><ellipse cx="1089" cy="2333.6158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="1098" y="2338.3747">metrics: Dict[str, float]</text><ellipse cx="1089" cy="2348.5977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="1098" y="2353.3566">by_regime: Dict[str, Dict]</text><ellipse cx="1089" cy="2363.5796" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="1098" y="2368.3385">by_market: Dict[str, Dict]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1079" x2="1257" y1="2375.5614" y2="2375.5614"/><!--MD5=[2a9217e8f2d7f96589335d2c6f09894a]
class Experiment--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="148.5796" id="Experiment" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="901.5" y="2227.5"/><ellipse cx="936.75" cy="2248.8441" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M939.7188,2254.4847 Q939.1406,2254.7816 938.5,2254.9222 Q937.8594,2255.0785 937.1563,2255.0785 Q934.6563,2255.0785 933.3281,2253.4379 Q932.0156,2251.7816 932.0156,2248.6566 Q932.0156,2245.5316 933.3281,2243.8754 Q934.6563,2242.2191 937.1563,2242.2191 Q937.8594,2242.2191 938.5,2242.3754 Q939.1563,2242.5316 939.7188,2242.8285 L939.7188,2245.5472 Q939.0938,2244.9691 938.5,2244.7035 Q937.9063,2244.4222 937.2813,2244.4222 Q935.9375,2244.4222 935.25,2245.5004 Q934.5625,2246.5629 934.5625,2248.6566 Q934.5625,2250.7504 935.25,2251.8285 Q935.9375,2252.891 937.2813,2252.891 Q937.9063,2252.891 938.5,2252.6254 Q939.0938,2252.3441 939.7188,2251.766 L939.7188,2254.4847 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="62" x="956.25" y="2245.3281">«dataclass»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="955.25" y="2261.6722">Experiment</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="902.5" x2="1041.5" y1="2270.1882" y2="2270.1882"/><ellipse cx="912.5" cy="2281.1882" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="95" x="921.5" y="2285.9471">experiment_id: str</text><ellipse cx="912.5" cy="2296.1701" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="921.5" y="2300.929">engine_name: str</text><ellipse cx="912.5" cy="2311.152" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="921.5" y="2315.9109">base_config_id: str</text><ellipse cx="912.5" cy="2326.1339" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="921.5" y="2330.8928">proposed_config: Dict</text><ellipse cx="912.5" cy="2341.1158" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="51" x="921.5" y="2345.8747">status: str</text><ellipse cx="912.5" cy="2356.0977" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="921.5" y="2360.8566">created_at: datetime</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="902.5" x2="1041.5" y1="2368.0796" y2="2368.0796"/><!--MD5=[7572c3a67143d3dade99115827d21663]
class DAGOrchestrator--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="137.8913" id="DAGOrchestrator" style="stroke: #A80036; stroke-width: 1.5;" width="299" x="3066.5" y="2233"/><ellipse cx="3162.75" cy="2249" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M3165.7188,2254.6406 Q3165.1406,2254.9375 3164.5,2255.0781 Q3163.8594,2255.2344 3163.1563,2255.2344 Q3160.6563,2255.2344 3159.3281,2253.5938 Q3158.0156,2251.9375 3158.0156,2248.8125 Q3158.0156,2245.6875 3159.3281,2244.0313 Q3160.6563,2242.375 3163.1563,2242.375 Q3163.8594,2242.375 3164.5,2242.5313 Q3165.1563,2242.6875 3165.7188,2242.9844 L3165.7188,2245.7031 Q3165.0938,2245.125 3164.5,2244.8594 Q3163.9063,2244.5781 3163.2813,2244.5781 Q3161.9375,2244.5781 3161.25,2245.6563 Q3160.5625,2246.7188 3160.5625,2248.8125 Q3160.5625,2250.9063 3161.25,2251.9844 Q3161.9375,2253.0469 3163.2813,2253.0469 Q3163.9063,2253.0469 3164.5,2252.7813 Q3165.0938,2252.5 3165.7188,2251.9219 L3165.7188,2254.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="3183.25" y="2253.656">DAGOrchestrator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="3067.5" x2="3364.5" y1="2265" y2="2265"/><ellipse cx="3077.5" cy="2276" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="273" x="3086.5" y="2280.7589">schedule_dag(dag_id: str, market_id: str, trigger: str)</text><ellipse cx="3077.5" cy="2290.9819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="3086.5" y="2295.7408">get_dag_status(dag_id: str) : DagStatus</text><ellipse cx="3077.5" cy="2305.9638" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="3086.5" y="2310.7227">retry_failed_tasks(dag_id: str)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="3067.5" x2="3364.5" y1="2317.9457" y2="2317.9457"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3074.5" y="2325.9457"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="187" x="3086.5" y="2333.7046">_build_dag_graph(dag_id: str) : DAG</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3074.5" y="2340.9276"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="3086.5" y="2348.6865">_check_dependencies(task_id: str) : bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3074.5" y="2355.9094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="3086.5" y="2363.6684">_execute_task(task_id: str)</text><!--MD5=[ab20db7a0b9255cbcd6e2af669ed35f9]
class MarketStateMonitor--><rect fill="#FEFECE" filter="url(#f8357kn0r3jmr)" height="92.9457" id="MarketStateMonitor" style="stroke: #A80036; stroke-width: 1.5;" width="381" x="3045.5" y="2526.5"/><ellipse cx="3175.25" cy="2542.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M3178.2188,2548.1406 Q3177.6406,2548.4375 3177,2548.5781 Q3176.3594,2548.7344 3175.6563,2548.7344 Q3173.1563,2548.7344 3171.8281,2547.0938 Q3170.5156,2545.4375 3170.5156,2542.3125 Q3170.5156,2539.1875 3171.8281,2537.5313 Q3173.1563,2535.875 3175.6563,2535.875 Q3176.3594,2535.875 3177,2536.0313 Q3177.6563,2536.1875 3178.2188,2536.4844 L3178.2188,2539.2031 Q3177.5938,2538.625 3177,2538.3594 Q3176.4063,2538.0781 3175.7813,2538.0781 Q3174.4375,2538.0781 3173.75,2539.1563 Q3173.0625,2540.2188 3173.0625,2542.3125 Q3173.0625,2544.4063 3173.75,2545.4844 Q3174.4375,2546.5469 3175.7813,2546.5469 Q3176.4063,2546.5469 3177,2546.2813 Q3177.5938,2546 3178.2188,2545.4219 L3178.2188,2548.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="113" x="3195.75" y="2547.156">MarketStateMonitor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="3046.5" x2="3425.5" y1="2558.5" y2="2558.5"/><ellipse cx="3056.5" cy="2569.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="3065.5" y="2574.2589">get_current_state(market_id: str) : MarketState</text><ellipse cx="3056.5" cy="2584.4819" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="355" x="3065.5" y="2589.2408">wait_for_state(market_id: str, target_state: MarketState, timeout: int)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="3046.5" x2="3425.5" y1="2596.4638" y2="2596.4638"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="3053.5" y="2604.4638"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="341" x="3065.5" y="2612.2227">_check_session_times(market_id: str, now: datetime) : MarketState</text><!--MD5=[5e9adaaa442e20829012618af8626f31]
link DataReader to Database--><path d="M2163.31,2368.47 C2075.94,2393.95 1989.25,2422 1950,2443 C1917.56,2460.36 1885.43,2484.87 1858.7,2507.87 " fill="none" id="DataReader-&gt;Database" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1854.8,2511.26,1864.225,2508.4019,1858.5832,2507.9908,1858.9943,2502.3489,1854.8,2511.26" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2013" y="2430.897">uses</text><!--MD5=[3eb42d09ed652ecd7f1244112743fa65]
link FeatureBuilder to DataReader--><path d="M2676.85,2115.07 C2628.65,2148.16 2570.46,2188.1 2520.39,2222.47 " fill="none" id="FeatureBuilder-&gt;DataReader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2516.18,2225.36,2525.8625,2223.5574,2520.3002,2222.5274,2521.3303,2216.9651,2516.18,2225.36" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2625" y="2161.897">uses</text><!--MD5=[d1cf4da438c3d9b115511e7ee41b456d]
link TextEncoder to Config--><path d="M945.15,2115.07 C965.08,2124.75 986.18,2133.34 1007,2139 C1106.57,2166.09 1853.65,2110.53 1935,2174 C2030.25,2248.32 1915.62,2360.84 2011,2435 C2031.45,2450.9 2219.72,2433.96 2244,2443 C2281.12,2456.82 2316.14,2482.92 2343.89,2508.04 " fill="none" id="TextEncoder-&gt;Config" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2347.59,2511.41,2343.668,2502.3757,2343.9078,2508.0275,2338.256,2508.2673,2347.59,2511.41" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1985" y="2307.397">uses</text><!--MD5=[03a6b9f5890cfac73c5d296dc3d91c08]
link NumericWindowEncoder to DataReader--><path d="M1448.37,2115.09 C1479.76,2124.88 1512.52,2133.49 1544,2139 C1594.79,2147.9 1958.06,2134.17 2008,2147 C2025.52,2151.5 2027.49,2158.6 2044,2166 C2088.83,2186.09 2137.63,2205.73 2184.47,2223.54 " fill="none" id="NumericWindowEncoder-&gt;DataReader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2189.29,2225.37,2182.293,2218.4388,2184.6148,2223.5972,2179.4565,2225.919,2189.29,2225.37" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2045" y="2161.897">uses</text><!--MD5=[bf327e463c9c52144e3ac2ea3a340dac]
link ProfileService to DataReader--><path d="M693.04,1866.73 C670.85,1884.56 650.83,1905.95 638,1931 C595.86,2013.28 573.46,2072.81 638,2139 C691.65,2194.03 1945.28,2160.85 2021,2174 C2083.39,2184.84 2149.48,2203.74 2208.96,2223.71 " fill="none" id="ProfileService-&gt;DataReader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2213.96,2225.39,2206.6988,2218.7361,2209.2195,2223.8003,2204.1552,2226.3209,2213.96,2225.39" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="639" y="2051.397">uses</text><!--MD5=[bff8e5030daa1f3c56ecbce841c4be88]
link ProfileService to TextEncoder--><path d="M825.86,1866.51 C827.71,1899.11 829.93,1938.21 831.83,1971.49 " fill="none" id="ProfileService-&gt;TextEncoder" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="832.13,1976.78,835.61,1967.5665,831.8448,1971.7881,827.6231,1968.0229,832.13,1976.78" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="830" y="1918.897">uses</text><!--MD5=[bcd7724e91aab865c7c88db3cac42805]
link RegimeEngine to JointEncoder--><path d="M1798.62,1866.51 C1797.91,1901.69 1797.04,1944.44 1796.33,1979.28 " fill="none" id="RegimeEngine-&gt;JointEncoder" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1796.23,1984.36,1800.4092,1975.4418,1796.33,1979.361,1792.4108,1975.2818,1796.23,1984.36" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1798" y="1918.897">uses</text><!--MD5=[58094dcd3e7483eba685991bef744c70]
link RegimeEngine to DataReader--><path d="M1966.62,1866.6 C1995.64,1884.22 2023.4,1905.57 2045,1931 C2108.33,2005.56 2054.24,2063.96 2117,2139 C2144.84,2172.28 2181.36,2200.01 2219.04,2222.58 " fill="none" id="RegimeEngine-&gt;DataReader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2223.64,2225.31,2217.949,2217.2718,2219.3425,2222.7543,2213.86,2224.1478,2223.64,2225.31" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2118" y="2051.397">uses</text><!--MD5=[26f656926ef977cb715c55df88054b77]
link StabilityEngine to ProfileService--><path d="M1368.3,1597.64 C1332.7,1614.24 1293.53,1630.5 1256,1642 C1161.33,1671 1129.55,1644.59 1036,1677 C1000.31,1689.37 963.64,1707.52 930.96,1725.97 " fill="none" id="StabilityEngine-&gt;ProfileService" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="926.59,1728.45,936.3919,1727.4889,930.9391,1725.9831,932.4449,1720.5304,926.59,1728.45" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1225" y="1664.897">uses</text><!--MD5=[60abce1180dcc30ea60ad2fba40d37e2]
link StabilityEngine to RegimeEngine--><path d="M1574.24,1597.57 C1618.5,1636.56 1673.99,1685.46 1718.87,1725.01 " fill="none" id="StabilityEngine-&gt;RegimeEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1722.63,1728.33,1718.5246,1719.3776,1718.8796,1725.0233,1713.2339,1725.3783,1722.63,1728.33" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1649" y="1664.897">uses</text><!--MD5=[401a5a665741eab93cf0026b6e152341]
link FragilityAlphaEngine to StabilityEngine--><path d="M1438.38,1321.21 C1449.87,1361.64 1464.43,1412.88 1476.17,1454.18 " fill="none" id="FragilityAlphaEngine-&gt;StabilityEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1477.58,1459.17,1478.9613,1449.4185,1476.2102,1454.3613,1471.2673,1451.6102,1477.58,1459.17" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1456" y="1380.897">uses</text><!--MD5=[84804a7bc65b2719a9b17fb2399ec45b]
link AssessmentEngine to RegimeEngine--><path d="M1736.88,1037.19 C1743.64,1064.04 1750.64,1095.28 1755,1124 C1787.81,1340.24 1796.7,1599.21 1799.1,1723.24 " fill="none" id="AssessmentEngine-&gt;RegimeEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1799.2,1728.32,1803.0451,1719.2528,1799.1143,1723.3207,1795.0463,1719.3899,1799.2,1728.32" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1783" y="1380.897">uses</text><!--MD5=[a1a3781f80d9c2328ca54f3739907574]
link AssessmentEngine to StabilityEngine--><path d="M1721.18,1037.08 C1722.18,1117.82 1715.02,1254.49 1664,1358 C1646,1394.53 1617.1,1428.05 1588.36,1455.48 " fill="none" id="AssessmentEngine-&gt;StabilityEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1584.49,1459.13,1593.7789,1455.8563,1588.1243,1455.696,1588.2845,1450.0415,1584.49,1459.13" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1719" y="1257.397">uses</text><!--MD5=[9fdd3b2e888219fd55456ea7d1584c53]
link AssessmentEngine to FragilityAlphaEngine--><path d="M1645.62,1037.26 C1600.06,1080.23 1541.35,1135.61 1495.1,1179.23 " fill="none" id="AssessmentEngine-&gt;FragilityAlphaEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1491.23,1182.88,1500.5253,1179.6245,1494.871,1179.4532,1495.0423,1173.7989,1491.23,1182.88" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1578" y="1111.897">uses</text><!--MD5=[fcd848151f00704e9aa9afe6132fabc5]
link UniverseEngine to AssessmentEngine--><path d="M1718,753.26 C1718,795.71 1718,850.27 1718,893.64 " fill="none" id="UniverseEngine-&gt;AssessmentEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1718,898.88,1722,889.88,1718,893.88,1714,889.88,1718,898.88" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1719" y="812.897">uses</text><!--MD5=[6123220433db6884d285b21aff94c368]
link PortfolioEngine to UniverseEngine--><path d="M1912.79,469.26 C1873.71,512.14 1823.37,567.38 1783.65,610.96 " fill="none" id="PortfolioEngine-&gt;UniverseEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1780.08,614.88,1789.0984,610.9216,1783.4476,611.1842,1783.1851,605.5334,1780.08,614.88" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1855" y="543.897">uses</text><!--MD5=[29abe03d504f695d8434532298483c03]
link PortfolioEngine to ScenarioEngine--><path d="M2093.79,469.08 C2173.81,514.95 2278.6,575.01 2356.77,619.82 " fill="none" id="PortfolioEngine-&gt;ScenarioEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2361.41,622.48,2355.586,614.5377,2357.0705,619.9962,2351.612,621.4808,2361.41,622.48" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2222" y="543.897">uses</text><!--MD5=[0d21cd4c7af7c78e1db3284ec4ac3ccc]
link OrderPlanner to PortfolioEngine--><path d="M2438.54,177.6 C2351.75,219.05 2222.33,280.86 2122.29,328.65 " fill="none" id="OrderPlanner-&gt;PortfolioEngine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2117.54,330.92,2127.3851,330.6487,2122.0514,328.7642,2123.9359,323.4305,2117.54,330.92" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="2322" y="244.897">uses</text><!--MD5=[fc5e37ebfa223386494d797496b0c0f5]
link LiveBroker to BrokerInterface--><path d="M2767.85,192.2 C2761.84,194.9 2755.87,197.52 2750,200 C2680.1,229.59 2652.68,215.69 2589,257 C2566.94,271.31 2545.9,289.92 2527.26,308.94 " fill="none" id="LiveBroker-&gt;BrokerInterface" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="2532.33,313.77,2513.51,323.49,2522.16,304.15,2532.33,313.77" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[09230a69be3c561c74c167e365bae39c]
link BacktestBroker to BrokerInterface--><path d="M3040.75,193.81 C3035.16,196.09 3029.56,198.17 3024,200 C3012.42,203.81 2599.86,251.48 2589,257 C2564.24,269.59 2541.53,288.61 2522.09,308.66 " fill="none" id="BacktestBroker-&gt;BrokerInterface" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="2527.24,313.41,2508.53,323.37,2516.94,303.92,2527.24,313.41" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[adcee1fb4efb7eeb74eb58ad654b9204]
link BacktestBroker to MarketSimulator--><path d="M3048.12,200.2 C3021.95,218.48 2993.81,238.35 2968,257 C2929.51,284.81 2887.14,316.38 2852.2,342.68 " fill="none" id="BacktestBroker-&gt;MarketSimulator" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2847.98,345.86,2857.575,343.6381,2851.9731,342.8509,2852.7604,337.2491,2847.98,345.86" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="3002" y="244.897">uses</text><!--MD5=[6ad289b4a38d6e6253eb9d297a291f62]
link BacktestBroker to TimeMachine--><path d="M3139.86,200.07 C3135.58,240.88 3130.17,292.53 3125.92,332.97 " fill="none" id="BacktestBroker-&gt;TimeMachine" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="3125.36,338.35,3130.2891,329.8233,3125.8886,333.378,3122.334,328.9775,3125.36,338.35" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="3137" y="244.897">uses</text><!--MD5=[bf6f776b1ba1177b7991903c1b7d9fc1]
link MetaOrchestrator to Database--><path d="M1658.31,2378.65 C1686.3,2419.13 1720.42,2468.47 1747.18,2507.18 " fill="none" id="MetaOrchestrator-&gt;Database" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1750.08,2511.37,1748.2546,2501.6918,1747.2377,2507.2565,1741.673,2506.2395,1750.08,2511.37" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="1694" y="2430.897">uses</text><!--MD5=[82bda54c88674127ca5df1e658bc3141]
link DAGOrchestrator to TradingCalendar--><path d="M3099.12,2371.05 C3039.08,2406.01 2965.3,2448.97 2901.39,2486.18 " fill="none" id="DAGOrchestrator-&gt;TradingCalendar" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="2896.8,2488.85,2906.5915,2487.7884,2901.1235,2486.3386,2902.5733,2480.8707,2896.8,2488.85" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="3013" y="2430.897">uses</text><!--MD5=[64c0e7b418231efda69beb358730efed]
link DAGOrchestrator to MarketStateMonitor--><path d="M3221.07,2371.23 C3224.54,2417.89 3229.07,2478.75 3232.22,2521.18 " fill="none" id="DAGOrchestrator-&gt;MarketStateMonitor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="3232.6,2526.26,3235.9203,2516.9877,3232.2285,2521.2738,3227.9424,2517.582,3232.6,2526.26" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="3226" y="2430.897">uses</text><!--MD5=[5d0dc4d413afacdd77f55e1ec5678451]
@startuml Prometheus v2 - Complete System Components



package "prometheus.core" <<Rectangle>> #E8F5E9 {
    
    class Config {
        +load_config(path: str) : Dict
        +get_engine_config(engine_name: str) : BaseModel
        +validate_config(config: Dict) : bool
        - -
        -_resolve_overlays(base: Dict, env: Dict) : Dict
        -_instantiate_models(config: Dict) : BaseModel
    }
    
    class Database {
        +get_connection(db_name: str) : Connection
        +execute_query(query: str, params: Dict) : Result
        +get_session() : Session
        - -
        -_create_pool(config: DbConfig) : ConnectionPool
        -_health_check() : bool
    }
    
    class Logger {
        +log_info(msg: str, **kwargs)
        +log_warning(msg: str, **kwargs)
        +log_error(msg: str, **kwargs)
        +log_decision(engine: str, decision: Dict)
        - -
        -_format_message(msg: str, context: Dict) : str
    }
    
    class TradingCalendar {
        +is_trading_day(market_id: str, date: date) : bool
        +get_prev_trading_day(market_id: str, date: date, n: int) : date
        +get_next_trading_day(market_id: str, date: date, n: int) : date
        +session_open(market_id: str, date: date) : datetime
        +session_close(market_id: str, date: date) : datetime
        +get_market_state(market_id: str, now: datetime) : MarketState
        - -
        -_load_calendar(market_id: str) : Calendar
        -_is_holiday(market_id: str, date: date) : bool
    }
    
    class IDGenerator {
        +generate_uuid() : str
        +generate_order_id() : str
        +generate_decision_id() : str
        +generate_context_id(date: date, portfolio: str, strategy: str) : str
    }
}


package "prometheus.data" <<Rectangle>> #FFF3E0 {
    
    class DataReader {
        +read_prices(instrument_ids: List[str], start: date, end: date) : DataFrame
        +read_returns(instrument_ids: List[str], start: date, end: date) : DataFrame
        +read_factors(factor_ids: List[str], start: date, end: date) : DataFrame
        +read_profiles(issuer_ids: List[str], as_of_date: date) : List[ProfileSnapshot]
        +read_embeddings(entity_ids: List[str], model_id: str, as_of_date: date) : Dict[str, ndarray]
        - -
        -_build_query(table: str, filters: Dict) : str
        -_fetch_batch(query: str, batch_size: int) : Iterator[DataFrame]
    }
    
    class FeatureBuilder {
        +build_returns_windows(prices: DataFrame, windows: List[int]) : DataFrame
        +build_volatility(returns: DataFrame, windows: List[int]) : DataFrame
        +build_factor_exposures(returns: DataFrame, factors: DataFrame) : DataFrame
        +build_correlation_matrix(returns: DataFrame, window: int) : ndarray
        - -
        -_rolling_window(series: Series, window: int, func: Callable) : Series
        -_compute_ewma(series: Series, halflife: int) : Series
    }
    
    class DataWriter {
        +write_prices(df: DataFrame, table: str)
        +write_embeddings(embeddings: Dict[str, ndarray], model_id: str)
        +write_engine_output(engine_name: str, output: Dict)
        - -
        -_validate_schema(df: DataFrame, table: str) : bool
        -_batch_insert(df: DataFrame, table: str, batch_size: int)
    }
}


package "prometheus.encoders" <<Rectangle>> #FFF3E0 {
    
    class TextEncoder {
        +encode(texts: List[str]) : ndarray
        +encode_batch(texts: List[str], batch_size: int) : ndarray
        +get_embedding_dim() : int
        - -
        -_preprocess(text: str) : str
        -_tokenize(text: str) : List[int]
        -_forward(tokens: Tensor) : Tensor
    }
    
    class NumericWindowEncoder {
        +embed_window(entity_type: str, entity_id: str, as_of_date: date, window_days: int) : ndarray
        +embed_batch(entities: List[Tuple], as_of_date: date) : Dict[str, ndarray]
        +train(data: DataFrame, epochs: int, lr: float)
        - -
        -_extract_features(entity: str, window: DataFrame) : Tensor
        -_forward(features: Tensor) : Tensor
        -_compute_loss(pred: Tensor, target: Tensor) : float
    }
    
    class JointEncoder {
        +embed_multimodal(numeric_emb: ndarray, text_emb: ndarray) : ndarray
        +embed_regime_window(market_id: str, as_of_date: date, window_days: int) : ndarray
        +train_contrastive(pairs: List[Tuple], epochs: int)
        - -
        -_fusion_layer(emb1: Tensor, emb2: Tensor) : Tensor
        -_project_to_joint_space(emb: Tensor) : Tensor
    }
}


package "prometheus.profiles" <<Rectangle>> #FFF3E0 {
    
    class ProfileService {
        +get_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot
        +build_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot
        +update_profiles(issuer_ids: List[str], as_of_date: date)
        - -
        -_fetch_fundamentals(issuer_id: str, as_of_date: date) : Dict
        -_compute_risk_flags(fundamentals: Dict) : Dict
        -_embed_profile(profile: ProfileSnapshot) : ndarray
    }
    
    class ProfileSnapshot <<dataclass>> {
        +issuer_id: str
        +as_of_date: date
        +structured: Dict
        +embedding: ndarray
        +risk_flags: Dict
        +metadata: Dict
    }
    
    class ProfileBuilder {
        +build_corporate_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot
        +build_sovereign_profile(issuer_id: str, as_of_date: date) : ProfileSnapshot
        - -
        -_extract_financials(issuer_id: str) : Dict
        -_compute_ratios(financials: Dict) : Dict
    }
}


package "prometheus.regime" <<Rectangle>> #FFEBEE {
    
    class RegimeEngine {
        +get_regime(as_of_date: date, region: str) : RegimeState
        +get_history(start_date: date, end_date: date, region: str) : List[RegimeState]
        +get_transition_matrix(region: str) : Dict[str, Dict[str, float]]
        - -
        -_compute_window_embedding(market_id: str, as_of_date: date) : ndarray
        -_classify_regime(embedding: ndarray) : str
        -_compute_confidence(embedding: ndarray, regime: str) : float
    }
    
    class RegimeState <<dataclass>> {
        +as_of_date: date
        +region: str
        +regime_label: str
        +regime_embedding: ndarray
        +confidence: float
        +metadata: Dict
    }
    
    class RegimeClassifier {
        +predict(embedding: ndarray) : Tuple[str, float]
        +train_clusters(embeddings: ndarray, n_clusters: int)
        - -
        -_kmeans_fit(X: ndarray, k: int) : KMeans
        -_assign_cluster(embedding: ndarray) : int
    }
}


package "prometheus.stability" <<Rectangle>> #FFEBEE {
    
    class StabilityEngine {
        +compute_stability(entity_type: str, entity_id: str, as_of_date: date) : StabilityVector
        +compute_soft_target_class(entity_id: str, as_of_date: date) : SoftTargetClass
        +run_scenario_analysis(entity_id: str, scenarios: List[Scenario]) : Dict[str, float]
        - -
        -_compute_liquidity_score(entity_id: str, as_of_date: date) : float
        -_compute_volatility_score(entity_id: str, as_of_date: date) : float
        -_compute_contagion_risk(entity_id: str, as_of_date: date) : float
    }
    
    class StabilityVector <<dataclass>> {
        +entity_type: str
        +entity_id: str
        +as_of_date: date
        +liquidity_score: float
        +volatility_score: float
        +contagion_score: float
        +overall_score: float
        +metadata: Dict
    }
    
    class SoftTargetClass <<dataclass>> {
        +entity_id: str
        +as_of_date: date
        +soft_target_class: str
        +soft_target_score: float
        +weak_profile: float
        +instability: float
        +high_fragility: float
        +complacent_pricing: float
    }
}


package "prometheus.assessment.fragility" <<Rectangle>> #FFEBEE {
    
    class FragilityAlphaEngine {
        +compute_alpha(entity_id: str, as_of_date: date, horizon_days: int) : float
        +compute_soft_target_score(entity_id: str, as_of_date: date) : float
        +generate_trade_ideas(entities: List[str], as_of_date: date) : List[TradeIdea]
        - -
        -_compute_weak_profile(entity_id: str, as_of_date: date) : float
        -_compute_complacent_pricing(entity_id: str, as_of_date: date) : float
        -_combine_signals(profile: float, instability: float, fragility: float, pricing: float) : float
    }
    
    class TradeIdea <<dataclass>> {
        +entity_id: str
        +instrument_id: str
        +direction: str
        +trade_type: str
        +expected_payoff: float
        +confidence: float
        +rationale: str
    }
}


package "prometheus.assessment" <<Rectangle>> #FFEBEE {
    
    class AssessmentEngine {
        +score_universe(strategy_id: str, market_id: str, instrument_ids: List[str], as_of_date: date, horizon_days: int) : Dict[str, InstrumentScore]
        +score_strategy_default(strategy_id: str, market_id: str, as_of_date: date) : Dict[str, InstrumentScore]
        - -
        -_compute_value_alpha(instrument_id: str, as_of_date: date) : float
        -_compute_momentum_alpha(instrument_id: str, as_of_date: date) : float
        -_compute_quality_alpha(instrument_id: str, as_of_date: date) : float
        -_combine_alphas(alphas: Dict[str, float], regime: RegimeState) : float
    }
    
    class InstrumentScore <<dataclass>> {
        +instrument_id: str
        +as_of_date: date
        +horizon_days: int
        +expected_return: float
        +score: float
        +confidence: float
        +signal_label: str
        +alpha_components: Dict[str, float]
        +metadata: Dict
    }
}


package "prometheus.universe" <<Rectangle>> #FFEBEE {
    
    class UniverseEngine {
        +select(strategy_id: str, market_id: str, as_of_date: date) : Universe
        +filter_by_liquidity(instruments: List[str], min_volume: float) : List[str]
        +filter_by_constraints(instruments: List[str], constraints: Dict) : List[str]
        - -
        -_apply_core_filters(instruments: List[str]) : List[str]
        -_rank_by_scores(instruments: List[str], scores: Dict) : List[str]
        -_assign_tiers(ranked: List[str], tier_sizes: Dict) : Dict[str, List[str]]
    }
    
    class Universe <<dataclass>> {
        +strategy_id: str
        +market_id: str
        +as_of_date: date
        +core: List[str]
        +satellite: List[str]
        +watchlist: List[str]
        +metadata: Dict
    }
}


package "prometheus.portfolio" <<Rectangle>> #FFEBEE {
    
    class PortfolioEngine {
        +optimize(strategy_id: str, as_of_date: date, universe: Universe, scores: Dict[str, InstrumentScore]) : Dict[str, float]
        +compute_risk_report(portfolio_id: str, as_of_date: date) : RiskReport
        +run_scenario_analysis(portfolio_id: str, scenarios: List[Scenario]) : Dict[str, float]
        - -
        -_build_optimization_problem(universe: List[str], scores: Dict, constraints: Dict) : OptProblem
        -_solve_cvxpy(problem: OptProblem) : ndarray
        -_validate_solution(weights: ndarray, constraints: Dict) : bool
    }
    
    class RiskReport <<dataclass>> {
        +portfolio_id: str
        +as_of_date: date
        +portfolio_value: float
        +net_exposure: float
        +gross_exposure: float
        +leverage: float
        +risk_metrics: Dict
        +scenario_pnl: Dict
        +exposures_by_sector: Dict
    }
}


package "prometheus.synthetic" <<Rectangle>> #FFEBEE {
    
    class ScenarioEngine {
        +generate_scenarios(scenario_type: str, n_scenarios: int, params: Dict) : ScenarioSet
        +simulate_paths(instrument_ids: List[str], start_date: date, end_date: date, scenario_set: ScenarioSet) : Dict[str, DataFrame]
        - -
        -_calibrate_model(historical_returns: DataFrame) : Dict
        -_sample_shocks(n_scenarios: int, params: Dict) : ndarray
        -_generate_path(instrument_id: str, shocks: ndarray) : Series
    }
    
    class ScenarioSet <<dataclass>> {
        +scenario_set_id: str
        +set_type: str
        +generated_date: date
        +n_scenarios: int
        +params: Dict
        +metadata: Dict
    }
}


package "prometheus.execution" <<Rectangle>> #E3F2FD {
    
    interface BrokerInterface {
        {abstract} +submit_order(order: Order) : str
        {abstract} +cancel_order(order_id: str) : bool
        {abstract} +get_order_status(order_id: str) : OrderStatus
        {abstract} +get_fills(since: datetime) : List[Fill]
        {abstract} +get_positions() : Dict[str, Position]
        {abstract} +get_account_state() : Dict
        {abstract} +sync()
    }
    
    class LiveBroker {
        +submit_order(order: Order) : str
        +cancel_order(order_id: str) : bool
        +get_positions() : Dict[str, Position]
        - -
        -_connect_ibkr() : IB
        -_translate_order(order: Order) : IBOrder
        -_handle_fill_event(fill: IBFill)
    }
    
    class BacktestBroker {
        +submit_order(order: Order) : str
        +process_fills(as_of_date: date)
        +get_positions() : Dict[str, Position]
        - -
        -market_simulator: MarketSimulator
        -time_machine: TimeMachine
        -pending_orders: List[Order]
    }
    
    class MarketSimulator {
        +simulate_fill(order: Order, as_of_date: date) : Fill
        +get_fill_price(order: Order, prices: DataFrame) : float
        - -
        -_apply_slippage(price: float, order: Order) : float
        -_check_volume_constraint(order: Order, volume: float) : bool
    }
    
    class TimeMachine {
        +set_date(as_of_date: date)
        +get_data(table: str, filters: Dict) : DataFrame
        +iter_trading_days() : Iterator[date]
        - -
        -current_date: date
        -_validate_no_lookahead(requested_date: date)
    }
    
    class OrderPlanner {
        +plan_orders(current_positions: Dict, target_positions: Dict) : List[Order]
        - -
        -_compute_deltas(current: Dict, target: Dict) : Dict
        -_split_large_orders(order: Order, max_size: float) : List[Order]
    }
}


package "prometheus.meta" <<Rectangle>> #F3E5F5 {
    
    class MetaOrchestrator {
        +engine_performance(engine_name: str, config_id: str, start: date, end: date) : EnginePerformanceReport
        +compare_configs(engine_name: str, config_ids: List[str], start: date, end: date) : Dict[str, EnginePerformanceReport]
        +create_experiment(engine_name: str, base_config: str, proposed_config: Dict) : Experiment
        +experiment_results(experiment_id: str) : ExperimentResult
        - -
        -_aggregate_decisions(engine: str, config: str, period: Tuple[date, date]) : DataFrame
        -_compute_metrics(decisions: DataFrame, outcomes: DataFrame) : Dict
        -_slice_by_regime(decisions: DataFrame, regimes: DataFrame) : Dict[str, DataFrame]
    }
    
    class EnginePerformanceReport <<dataclass>> {
        +engine_name: str
        +config_id: str
        +period_start: date
        +period_end: date
        +metrics: Dict[str, float]
        +by_regime: Dict[str, Dict]
        +by_market: Dict[str, Dict]
    }
    
    class Experiment <<dataclass>> {
        +experiment_id: str
        +engine_name: str
        +base_config_id: str
        +proposed_config: Dict
        +status: str
        +created_at: datetime
    }
}


package "prometheus.orchestration" <<Rectangle>> #F3E5F5 {
    
    class DAGOrchestrator {
        +schedule_dag(dag_id: str, market_id: str, trigger: str)
        +get_dag_status(dag_id: str) : DagStatus
        +retry_failed_tasks(dag_id: str)
        - -
        -_build_dag_graph(dag_id: str) : DAG
        -_check_dependencies(task_id: str) : bool
        -_execute_task(task_id: str)
    }
    
    class MarketStateMonitor {
        +get_current_state(market_id: str) : MarketState
        +wait_for_state(market_id: str, target_state: MarketState, timeout: int)
        - -
        -_check_session_times(market_id: str, now: datetime) : MarketState
    }
}


DataReader ..> Database : uses
FeatureBuilder ..> DataReader : uses
TextEncoder ..> Config : uses
NumericWindowEncoder ..> DataReader : uses
ProfileService ..> DataReader : uses
ProfileService ..> TextEncoder : uses

RegimeEngine ..> JointEncoder : uses
RegimeEngine ..> DataReader : uses
StabilityEngine ..> ProfileService : uses
StabilityEngine ..> RegimeEngine : uses
FragilityAlphaEngine ..> StabilityEngine : uses
AssessmentEngine ..> RegimeEngine : uses
AssessmentEngine ..> StabilityEngine : uses
AssessmentEngine ..> FragilityAlphaEngine : uses
UniverseEngine ..> AssessmentEngine : uses
PortfolioEngine ..> UniverseEngine : uses
PortfolioEngine ..> ScenarioEngine : uses

OrderPlanner ..> PortfolioEngine : uses
LiveBroker ..|> BrokerInterface
BacktestBroker ..|> BrokerInterface
BacktestBroker ..> MarketSimulator : uses
BacktestBroker ..> TimeMachine : uses

MetaOrchestrator ..> Database : uses
DAGOrchestrator ..> TradingCalendar : uses
DAGOrchestrator ..> MarketStateMonitor : uses

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.9+10-Debian-1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>